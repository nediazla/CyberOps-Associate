# Módulo 25. Monitorización de la Seguridad y Tipos de Datos (visión SOC)

Este módulo cubre:

1. ¿Qué es la monitorización?
    
2. Tipos de datos que ve un SOC
    
3. Normalización, enriquecimiento, parsing
    
4. Logs de red, endpoint, aplicación, identidad
    
5. SIEM: arquitectura y funcionamiento
    
6. Retención, integridad y cadena de custodia
    
7. Telemetría (Flow, PCAP, eventos, metadatos)
    
8. Alertas, reglas y correlación
    
9. Capacidades de visualización
    
10. MITRE ATT&CK relacionado
    

---

# 1. ¿Qué es la monitorización en ciberseguridad?

Es la capacidad de:

- recopilar
    
- almacenar
    
- analizar
    
- correlacionar
    
- alertar
    

sobre todos los eventos relevantes de seguridad.

Sin monitorización, el SOC no “ve” el ataque.

---

# 2. Tipos de datos que gestiona un SOC

Un analista debe reconocer cada uno.

## 2.1 Logs (eventos estructurados)

Datos generados por sistemas:

- Windows Event Logs
    
- Linux syslog
    
- firewall logs
    
- VPN logs
    
- proxy logs
    
- DNS logs
    
- DHCP logs
    
- autenticación
    

## 2.2 Flujos (Flow)

NetFlow / IPFIX:

- IP origen/destino
    
- puerto
    
- bytes
    
- dirección
    
- protocolo
    
- duración
    

Flow no muestra payload, pero sí patrones.

## 2.3 PCAP (captura completa de paquetes)

Muestra:

- contenido completo de los paquetes
    
- protocolos
    
- payload
    
- flags
    

PCAP = evidencia forense.

## 2.4 Telemetría de Endpoint (EDR)

Incluye:

- procesos
    
- conexiones
    
- árboles de proceso
    
- archivos creados
    
- actividad de memoria
    

## 2.5 Metadatos

Información extra como:

- reputación de IP
    
- geolocalización
    
- tipo de dispositivo
    
- sistema operativo
    

---

# 3. Normalización y formato

Los SIEM normalizan eventos usando formatos como:

- **CEF** (ArcSight Common Event Format)
    
- **LEEF** (QRadar)
    
- **JSON**
    
- **Syslog RFC 5424**
    

El objetivo:

- convertir logs diferentes en un formato común
    
- facilitar reglas de correlación
    
- evitar ambigüedades
    

Ejemplo:

```
src_ip = 10.10.10.5
dest_ip = 172.16.1.7
event_type = login_failed
```

---

# 4. Enriquecimiento (Enrichment)

Proceso de añadir información a un evento para hacerlo más útil.

Ejemplos de enriquecimiento:

- reputación de IP
    
- clasificación de URL
    
- reverse DNS
    
- geolocalización
    
- usuario asociado a IP
    
- grupo del usuario
    
- hostname
    
- hash reputation (VT, Talos)
    

Sin enriquecimiento, las alertas generan demasiados falsos positivos.

---

# 5. Logs relevantes para un SOC

## 5.1 Logs de red

- Firewall
    
- Router/switch
    
- IDS/IPS
    
- Proxy
    
- VPN
    
- DNS
    
- DHCP
    

## 5.2 Logs de sistema

### Windows:

- 4624, 4625, 4672, 4688
    
- Sysmon
    

### Linux:

- /var/log/auth.log
    
- systemd
    
- auditd
    

## 5.3 Logs de aplicación

- Apache/Nginx
    
- servidores API
    
- bases de datos
    
- correo
    

## 5.4 Logs de seguridad

- EDR
    
- antivirus
    
- NAC
    
- MDM
    

---

# 6. SIEM: arquitectura y funcionamiento

Un SIEM:

1. **Recolecta** eventos
    
2. **Normaliza**
    
3. **Almacena**
    
4. **Correlaciona**
    
5. **Enriquece**
    
6. **Alerta**
    
7. **Visualiza**
    
8. **Permite buscar** (KQL, SPL, SQL-like)
    

Ejemplos:

- Splunk
    
- Elastic Security
    
- Microsoft Sentinel
    
- IBM QRadar
    
- Wazuh
    

---

# 7. Retención y cadena de custodia

Importante en forense.

Requiere:

- integridad
    
- almacenamiento seguro
    
- hash de registros
    
- control de acceso
    
- timestamp preciso
    

En entornos serios, la retención es de 90 a 365 días.

---

# 8. Telemetría avanzada

### 8.1 Flow Analysis

Detecta:

- beaconing
    
- escaneos
    
- DoS
    
- exfiltración
    
- tráfico lateral
    

### 8.2 DNS Telemetry

Detecta:

- tunneling
    
- DGA
    
- dominios raros
    

### 8.3 Proxy Telemetry

Detecta:

- malware web
    
- acceso a C2
    
- descargas sospechosas
    

### 8.4 TLS Telemetry

Detecta:

- certificados extraños
    
- túneles ocultos
    
- SNI inconsistentes
    

---

# 9. Reglas y correlación

La correlación combina eventos para indicar ataque real.

Ejemplo:

1. 4625 fallos de login
    
2. 4624 éxito
    
3. 4672 privilegios especiales
    
4. Conexión RDP  
    = posible compromiso de credenciales.
    

Otro ejemplo:

- DNS TXT largo
    
- NetFlow con beaconing
    
- proceso PowerShell  
    = probable C2.
    

---

# 10. Visualización y dashboards

El SIEM debe permitir:

- ver tendencias
    
- detectar anomalías
    
- ver picos de tráfico
    
- correlacionar geolocalización
    
- ver árbol de alertas
    

Ejemplo:  
Una visualización de “failed logins por hora” puede revelar ataques de fuerza bruta.

---

# 11. MITRE ATT&CK relacionado

Este módulo cruza con prácticamente todo MITRE, pero destaca:

- **T1005 – Data from Local System**
    
- **T1041 – Exfiltration**
    
- **T1036 – Masquerading**
    
- **T1071 – Application Layer Protocol**
    
- **T1016 – Discovery: Network**
    
- **T1087 – Discovery: Accounts**
    
- **T1078 – Valid Accounts**
    

---

# 12. ¿Qué debe dominar un analista al terminar este módulo?

- Diferenciar logs, flows y PCAP
    
- Entender qué telemetría aporta cada fuente
    
- Saber usar un SIEM para investigar
    
- Leer y normalizar eventos
    
- Enriquecer alarmas
    
- Correlacionar actividad sospechosa
    
- Crear reglas básicas
    
- Identificar patrones repetitivos
    
- Diferenciar ruido vs ataque real
    
- Integrar inteligencia de amenazas con SIEM