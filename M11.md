# Módulo 11. Dispositivos de Comunicación de Red (visión SOC)

Este módulo describe:

- Tipos de dispositivos de red
    
- Qué función cumplen
    
- Qué ataques los afectan
    
- Qué señales generan
    
- Qué monitorea el SOC
    
- Qué logs se deben recolectar
    

---

# 1. Routers

El router enruta tráfico entre redes.

### Funciones clave:

- Routing (RIP, OSPF, EIGRP, BGP)
    
- NAT / PAT
    
- ACLs
    
- DHCP Relay
    
- VPN termination
    

### Señales SOC:

- Cambios inesperados en tabla de rutas
    
- Flapping de rutas
    
- NAT excesivo
    
- Conexiones VPN desde IPs no autorizadas
    
- Aumentos de TTL inconsistentes
    

### Logs relevantes:

- Syslog (nivel 5–7)
    
- SNMP traps
    
- NetFlow/IPFIX
    
- Config change logs (Cisco: %SYS-5-CONFIG_I)
    

### Ataques:

- Route manipulation
    
- BGP hijacking (externo)
    
- SNMPv2 enumeración
    
- Fuerza bruta SSH
    
- Exploits de IOS antiguos
    

---

# 2. Switches

Operan en capa 2 y controlan tráfico interno.

### Funciones:

- Forwarding
    
- VLANs
    
- Spanning Tree (STP)
    
- Port security
    
- QoS
    
- Link aggregation (LACP)
    

### Señales SOC:

- Cambios de MAC en un mismo puerto
    
- Port security violations
    
- STP topology change
    
- Broadcast storms
    
- VLAN hopping
    

### Ataques:

- ARP poisoning
    
- MAC flooding
    
- STP manipulation
    
- Rogue DHCP server
    

Logs:

- Syslog
    
- STP events
    
- Port security logs
    

---

# 3. Firewalls

Controlan tráfico permitiendo o bloqueando según reglas.

### Tipos:

- Stateless
    
- Stateful
    
- NGFW (Cisco FTD, Palo Alto, FortiGate)
    

### Señales SOC:

- Bloqueos repetitivos desde la misma IP
    
- Tráfico permitido por error
    
- Regla nueva o modificada
    
- Alta tasa de RST
    
- Conexiones a puertos prohibidos
    

Logs:

- Firewall events (deny/permit)
    
- Threat logs
    
- URL filtering logs
    
- IPS logs
    
- TLS decryption logs
    

Ataques:

- Enumeration of open ports
    
- Firewall evasion (fragmentación, non-RFC packets)
    
- Exploits a servicios expuestos
    

---

# 4. Wireless Access Points (AP) & WLC

Redes inalámbricas tienen análisis adicional.

### Componentes:

- AP (Access Point)
    
- WLC (Wireless LAN Controller)
    

### Riesgos:

- Rogue AP
    
- Evil Twin
    
- Ataques de desautenticación (Deauth)
    
- Captura de handshake WPA2
    
- MAC spoofing
    
- Saltarse portal cautivo
    

### Señales SOC:

- Nuevos SSIDs nunca antes vistos
    
- Clientes conectándose a un AP no autorizado
    
- Fluctuación de fuerza de señal indicando suplantación
    
- Eventos de deauth masivos
    

Logs:

- Wireless syslog
    
- WLC events
    
- RADIUS logs
    

Herramientas verificables:

- Kismet
    
- Aircrack-ng
    
- Wireshark 802.11 monitor mode
    

---

# 5. VPN Concentrators

Dispositivos o servicios encargados de terminar túneles VPN.

### Funciones:

- IPsec
    
- SSL VPN / AnyConnect
    
- IKEv1/v2 negotiation
    

### Señales SOC:

- Conexiones desde países inesperados
    
- Muchos fallos IKE
    
- Uso de certificados no autorizados
    
- Sesiones largas y sin tráfico (túnel persistente C2)
    

Logs:

- VPN logs (Cisco: ASA/FTD)
    
- AAA logs
    
- IKE negotiation events
    

---

# 6. Load Balancers (F5, HAProxy, Nginx)

Balancean carga de servicios web.

### Señales SOC:

- Aumentos de tráfico inesperado
    
- Errores 502/504 constantes
    
- Cambios en salud de backend
    
- Peticiones maliciosas dirigidas a un backend concreto
    

Logs:

- HTTP/WAF logs
    
- Pool member status
    

---

# 7. Proxies

Controlan y filtran tráfico HTTP/HTTPS.

### Riesgos:

- Proxy tunneling
    
- Bypass de políticas
    
- Malware descargando payload
    
- C2 sobre HTTPS
    

Señales SOC:

- User-agents sospechosos
    
- Tráfico hacia dominios recién creados
    
- Túneles CONNECT hacia IPs no estándar
    

Logs:

- Proxy access logs
    
- TLS SNI logs
    
- URL filtering
    

---

# 8. IDS / IPS

Sistemas de detección o prevención.

### Señales:

- Alertas de firmas
    
- Alertas de comportamiento
    
- Detección de tunnelings
    
- Evasión mediante fragmentación
    

Herramientas:

- Zeek
    
- Suricata
    
- Snort
    
- Cisco Firepower
    

---

# 9. Dispositivos IoT e industriales

En redes reales aparecen:

- Cámaras
    
- Sensores
    
- PLCs
    
- Impresoras
    
- Switches PoE pequeños
    

Riesgos:

- Firmware viejo
    
- Credenciales por defecto
    
- Exposición de servicios
    

Señales SOC:

- Tráfico extraño a Internet
    
- Consultas DNS raras
    
- Comunicación entre IoT que no debería existir
    

---

# 10. ¿Qué monitoriza realmente un SOC en dispositivos de red?

Un analista CyberOps lee:

- Syslog
    
- SNMP traps
    
- Config change logs
    
- NetFlow/IPFIX
    
- Estado de interfaces
    
- Eventos STP
    
- Eventos de port-security
    
- Conexiones VPN
    
- Fallos AAA
    
- Regeneración de DHCP
    
- Cambios en ARP
    

Esto permite detectar:

- MITM
    
- Intrusiones
    
- Movimiento lateral
    
- Escaneos internos
    
- Exfiltración
    
- Manipulación de rutas
    
- Fugas de configuración
    
- Ataques DoS
    

---

# 11. MITRE ATT&CK asociado

- **T1078 – Valid Accounts**
    
- **T1557 – Man-in-the-Middle**
    
- **T1498 – Network DoS**
    
- **T1040 – Network Sniffing**
    
- **T1190 – Exploit Public-Facing Applications**
    
- **T1595 – Active Scanning**
    
- **T1021 – Remote Services**
    

---

# 12. Conclusión operativa del módulo

Un analista de SOC debe ser capaz de:

- Entender qué hace cada dispositivo
    
- Leer sus logs
    
- Distinguir fallos de operación vs ataque
    
- Detectar comportamientos atípicos
    
- Correlacionar tráfico entre dispositivos
    
- Responder incidentes basados en señales reales