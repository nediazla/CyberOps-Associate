# Módulo 27. Interpretación de los Datos de Monitorización (visión SOC)

Este módulo cubre:

1. Cómo entender patrones normales (baseline)
    
2. Cómo detectar anomalías
    
3. Cómo interpretar logs, flow, PCAP, DNS y EDR
    
4. Cómo identificar señales débiles
    
5. Análisis estadístico vs análisis contextual
    
6. Detección basada en comportamiento
    
7. Detección basada en firmas
    
8. Clasificación de eventos
    
9. Correlación avanzada
    

---

# 1. Baseline: entender lo normal

Antes de detectar ataques, un SOC debe saber cómo luce el tráfico normal.

Ejemplos de baseline:

- número promedio de fallos de login por hora
    
- conexiones DNS por host
    
- tráfico de salida habitual
    
- conexiones RDP autorizadas
    
- volumen normal de NetFlow
    
- actividad típica del usuario
    

Sin baseline no existe “anomalía”, solo “ruido”.

---

# 2. Detección de Anomalías

Se considera anómalo lo que se desvía del baseline.

Ejemplos:

- tráfico DNS 10x superior al habitual
    
- un usuario inicia sesión desde un país donde nunca viaja
    
- conexiones RDP desde una IP nueva
    
- un servidor se conecta a Internet cuando nunca lo hace
    
- aumento repentino de 4625 (fallos de login)
    
- picos en NetFlow hacia un solo destino
    

Anomalía no significa ataque, pero **es una señal**.

---

# 3. Interpretación de Logs

Cada tipo de log cuenta su parte de la historia.

### Windows:

- 4624: inicio de sesión exitoso
    
- 4625: fallo
    
- 4688: creación de proceso
    
- 4672: privilegios especiales
    
- 1102: borrado de logs
    

Interpretación:

- muchos 4625 → brute force
    
- 4624 después de muchos 4625 → éxito de fuerza bruta
    
- winword.exe lanzando powershell.exe → phishing con macro
    

### Linux:

- auth.log: accesos SSH
    
- sudo logs
    
- journalctl
    

Interpretación:

- ssh repetido desde una IP nueva → reconocimiento
    
- root login directo → mala práctica o ataque
    
- cambios en authorized_keys → persistencia
    

### Firewall:

Indicadores:

- puertos inusuales
    
- rechazos repetidos
    
- conexiones salientes sospechosas
    

### Proxy:

Indicadores:

- acceso a dominios maliciosos
    
- descargas ejecutables
    
- exfiltración lenta
    

---

# 4. Interpretación de Flow (NetFlow/IPFIX)

Flow es estadístico, pero revela patrones clave:

- **Scanning**: muchas conexiones cortas a puertos diferentes
    
- **Beaconing**: intervalos regulares hacia una misma IP
    
- **C2 oculto**: bytes muy bajos + repeticiones
    
- **Exfiltración**: flujos largos, grandes volúmenes
    
- **DDoS**: PPS alto, muchas fuentes
    
- **Lateral movement**: SMB/RDP entre hosts internos
    

Ejemplo verificable:

```
src=10.1.20.5 → dst=8.8.8.8 every 60 seconds, 120 bytes
```

Beaconing claro.

---

# 5. Interpretación de PCAP

PCAP muestra el ataque “desnudo”.

Indicadores:

- payloads SQL/XSS
    
- exploits con shellcode
    
- flags TCP anómalos
    
- fragmentación sospechosa
    
- firma de reconocimiento (Nmap)
    
- intentos de protocolo extraño
    

PCAP no se usa siempre, pero es crucial en forense.

---

# 6. Interpretación de DNS

DNS revela C2, tunneling y malware.

Señales:

- NXDOMAIN repetidos
    
- consultas TXT grandes
    
- consultas a dominios recién creados
    
- patrones DGA (dominios aleatorios)
    
- DNS hacia servidores no autorizados
    
- Cambios súbitos en volumen DNS
    

---

# 7. Interpretación de EDR

EDR muestra la actividad interna:

- procesos parent/child
    
- conexiones de procesos
    
- archivos creados
    
- accesos a memoria
    
- intentos de credential dumping
    
- servicios anómalos
    

Ejemplos:

```
winword.exe → powershell.exe
```

phishing con macro.

```
lsass.exe memory access
```

credential dump.

---

# 8. Señales débiles (Weak Signals)

El analista debe detectar señales pequeñas que, combinadas, indican ataque.

Ejemplos:

- usuario accede en domingo → raro, pero no sospechoso solo
    
- conexión a dominio nuevo → raro, pero común
    
- PowerShell trivial → puede ser legítimo
    

Pero juntas:

- acceso domingo + dominio raro + PowerShell → ataque probable.
    

El arte del SOC es **combinar señales**.

---

# 9. Análisis Estadístico vs Contextual

### Estadístico:

- volumen
    
- frecuencia
    
- distribución
    
- outliers
    

Es bueno para anomalías.

### Contextual:

- rol del usuario
    
- ubicación
    
- permisos
    
- política de red
    
- actividad normal
    

Es bueno para determinar si la anomalía es maliciosa.

Un SOC maduro mezcla ambos.

---

# 10. Clasificación de eventos

Etapas:

1. Evento
    
2. Alerta
    
3. Incidente
    
4. Brecha
    

El analista clasifica:

- severidad
    
- urgencia
    
- impacto
    

Ejemplo:

- SQL Injection fallida → ALERTA
    
- SQL Injection exitosa → INCIDENTE
    
- extracción de datos → BRECHA
    

---

# 11. Correlación avanzada

La correlación combina datos separados:

Ejemplo:

- 4625 repetidos
    
- conexión SSH
    
- sudo sin contraseña
    
- descarga de archivo  
    = ataque en progreso.
    

Ejemplo 2:

- DNS TXT largo
    
- flow con beaconing
    
- proceso oculto  
    = C2 activo.
    

Ejemplo 3:

- RDP desde IP nueva
    
- cambios en registro
    
- creación de servicio  
    = persistencia + movimiento lateral.
    

---

# 12. MITRE ATT&CK relacionado

- **T1071 – Application Layer Protocol**
    
- **T1041 – Exfiltration**
    
- **T1036 – Masquerading**
    
- **T1134 – Access Token Manipulation**
    
- **T1059 – Command Execution**
    
- **T1021 – Remote Services**
    
- **T1069 – Permission Groups Discovery**
    
- **T1087 – Account Discovery**
    
- **T1018 – Remote System Discovery**
    

---

# 13. ¿Qué debe dominar un analista al terminar este módulo?

- Interpretar logs de múltiples fuentes
    
- Distinguir patrones normales vs sospechosos
    
- Leer flujos y encontrar scanning/beaconing
    
- Usar PCAP para confirmar explotación
    
- Encontrar señales débiles
    
- Correlacionar datos de red y endpoint
    
- Identificar C2 oculto
    
- Reconocer ataque completo a partir de partes dispersas
    
- Analizar datos sin sesgo
    
- Integrar baseline + contexto + inteligencia