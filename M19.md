# Módulo 19. Control de Acceso (visión SOC)

Este módulo se divide en:

1. Autenticación
    
2. Autorización
    
3. Accounting
    
4. AAA (RADIUS/TACACS+)
    
5. Control de acceso a red (NAC, 802.1X)
    
6. Modelos de control de acceso (DAC, MAC, RBAC, ABAC)
    
7. Políticas de acceso
    
8. Señales SOC típicas
    
9. MITRE ATT&CK asociado
    

---

# 1. Autenticación (Authentication)

Proceso de verificar la identidad del usuario o dispositivo.

Métodos comunes:

- Usuario/contraseña
    
- MFA (TOTP, SMS, push)
    
- Certificados digitales
    
- Kerberos (Windows)
    
- SSH keys
    
- SAML / OAuth
    

Señales SOC:

- Intentos fallidos repetidos
    
- Autenticaciones desde países inesperados
    
- Cambios repentinos de MFA
    
- Accesos en horarios no habituales
    

Logs:

- Windows: 4625/4624
    
- Linux: auth.log
    
- Firewall VPN logs
    

---

# 2. Autorización (Authorization)

Define lo que el usuario puede hacer.

Ejemplo:

- ¿Puede acceder al servidor de finanzas?
    
- ¿Puede ejecutar comandos privilegiados?
    
- ¿Puede usar RDP?
    

Modelos:

- RBAC (Role-Based Access Control)
    
- ABAC (Attribute-Based Access Control)
    
- DAC (Discretionary Access Control)
    
- MAC (Mandatory Access Control – SELinux/AppArmor)
    

Señales SOC:

- Acceso a recursos no habituales
    
- Elevación de privilegios (UAC bypass, sudo inesperado)
    
- Creación de grupos “administradores” nuevos
    

---

# 3. Accounting (Audit / Logging)

Registra:

- Quién accedió
    
- Qué hizo
    
- Cuánto tiempo
    
- Desde dónde
    

Este registro alimenta SIEM y permite detectar:

- Insider threats
    
- Acceso indebido
    
- Movimiento lateral
    
- Abuso de privilegios
    

Logs comunes:

- syslog
    
- Windows Security Logs
    
- TACACS+ accounting logs
    

---

# 4. AAA: Authentication, Authorization & Accounting

El estándar en control de acceso de red.

### Protocolos:

## 4.1 RADIUS

- Autenticación y autorización juntas
    
- Accounting separado
    
- UDP 1812 / 1813
    
- Usado para: WiFi, VPN, NAC
    

## 4.2 TACACS+

- Autenticación, autorización y accounting separados
    
- TCP 49
    
- Control granular de comandos
    
- Usado para: administración de dispositivos Cisco
    

Para el SOC, TACACS+ es oro para detectar abuso de privilegios.

Señales:

- Comandos ejecutados por usuarios inusuales
    
- Cambios de configuración fuera de horario
    
- Fallos de autenticación repetidos
    

---

# 5. NAC (Network Access Control)

Determina qué dispositivos pueden entrar a la red.

Ejemplo: Cisco ISE.

Tecnologías:

- **802.1X** (autenticación basada en puerto)
    
- **MAB** (MAC Authentication Bypass)
    
- **Posture** (estado del dispositivo: antivirus, parches, etc.)
    

Señales SOC:

- Fallos de 802.1X
    
- Dispositivos desconocidos intentando acceder
    
- MAC spoofing
    
- Cambios en perfil del dispositivo
    

---

# 6. Modelos de Control de Acceso (muy importantes)

## 6.1 DAC (Discretionary Access Control)

El dueño decide quién accede (Linux/Windows permisos estándar).

## 6.2 MAC (Mandatory Access Control)

El sistema impone niveles (MILS, SELinux, AppArmor).

## 6.3 RBAC (Role-Based Access Control)

Rol → permisos (sistemas empresariales).

## 6.4 ABAC (Attribute-Based Access Control)

Basado en atributos:  
usuario, hora, ubicación, tipo de dispositivo, departamento, riesgo.

En Zero Trust, ABAC es clave.

---

# 7. Políticas de acceso (Access Policies)

Ejemplos comunes:

- mínimo privilegio
    
- deny-all por defecto
    
- zero trust
    
- break-the-glass
    
- acceso sólo desde jump hosts
    
- acceso privilegiado con MFA obligatorio
    

Señales SOC:

- salto de políticas
    
- uso de cuentas con privilegios elevados fuera de horario
    
- autenticaciones desde redes no autorizadas
    

---

# 8. Señales SOC típicas relacionadas con control de acceso

|Señal|Posible Indicador|
|---|---|
|Muchos 4625|brute force|
|4624 + 4672|acceso privilegiado|
|Logons en horas inusuales|cuenta comprometida|
|Logon desde país nuevo|credential theft|
|Creación de usuario admin|persistencia|
|Sudo sin historial|abuso de credenciales|
|SSH desde IP desconocida|intrusión|
|Conexión VPN + múltiples fallos MFA|ataque activo|
|TACACS+ accounting con comandos sospechosos|manipulación de dispositivo|

---

# 9. Técnicas MITRE ATT&CK relacionadas

- **T1078 – Valid Accounts**
    
- **T1556 – Modify Authentication Process**
    
- **T1552 – Unsecured Credentials**
    
- **T1134 – Access Token Manipulation**
    
- **T1108 – Redundant Access**
    
- **T1087 – Account Discovery**
    
- **T1021 – Remote Services**
    

---

# 10. ¿Qué debe dominar un analista al terminar este módulo?

- Cómo funciona AAA (RADIUS/TACACS+)
    
- Interpretar logs de autenticación
    
- Detectar brute force
    
- Detectar abuso de credenciales
    
- Entender 802.1X y NAC (ISE)
    
- Distinguir DAC, RBAC, MAC, ABAC
    
- Saber identificar cambios en privilegios
    
- Detectar insidias y persistencia basada en acceso
    
- Monitorear acceso remoto (VPN/SSH/RDP)
    
- Ver relación entre identidad y movimiento lateral