# Módulo 2. Ciberseguridad: el Centro de Operaciones de Seguridad (SOC)

Un **Security Operations Center (SOC)** es una instalación —física, virtual o híbrida— donde un equipo coordina la **monitorización, detección, análisis, respuesta y mejora continua** de la seguridad de una organización.  
Cisco lo define como “la unidad encargada de la vigilancia permanente de amenazas mediante telemetría, herramientas y procedimientos estandarizados”.

El SOC combina:

- Personas
    
- Procesos
    
- Tecnología
    

Si falta uno, el SOC no funciona.

---

## 1. Tipos de SOC

Estos tipos están documentados en modelos de NIST y en la propia documentación de Cisco.

1. **SOC Interno (In-House)**  
    Operado dentro de la organización. Máximo control, costo alto.
    
2. **SOC Externo (MSSP – Managed Security Service Provider)**  
    Delegado a terceros. Menor costo, menos control.
    
3. **SOC Híbrido**  
    Parte interna y parte externa. El más común.
    
4. **SOC Distribuido / Virtual**  
    Analistas remotos, infraestructura en la nube. Basado en SIEM cloud-native.
    
5. **Fusion Center**  
    Integración SOC + NOC + equipos de riesgo y fraude. Modelo del FBI y DHS.
    

---

## 2. Roles dentro del SOC

Basado en el estándar de SANS y la estructura funcional del curso Cisco CyberOps.

**Nivel 1 – Analyst Tier 1**

- Monitoriza alertas del SIEM.
    
- Clasifica (triage).
    
- Escala incidentes.
    
- Recoge artefactos básicos.
    

**Nivel 2 – Analyst Tier 2**

- Realiza análisis profundo.
    
- Correlaciona eventos.
    
- Interpreta tácticas MITRE ATT&CK.
    
- Recomienda mitigaciones.
    
- Abre incident tickets.
    

**Nivel 3 – Threat Hunter / Incident Responder**

- Caza proactiva (hunting).
    
- Analiza patrones avanzados.
    
- Maneja IR (Incident Response).
    
- Usa YARA, Sigma, Sysmon, Volatility.
    

**SOC Manager**

- Coordina procesos.
    
- Supervisa KPIs y SLAs.
    
- Dirige estrategias de defensa.
    

**Forensic Analyst**

- Análisis de memoria
    
- Análisis de disco
    
- Preservación de evidencia
    
- Técnicas aceptadas por NIST 800-86.
    

**Threat Intelligence Analyst**

- Recolecta inteligencia externa (OSINT).
    
- Enlaza IOCs con campañas conocidas.
    
- Mantiene feeds actualizados (MISP, Anomali, etc.).
    

---

## 3. Arquitectura básica de un SOC

Aquí entran los componentes que en tu homelab puedes recrear con Wazuh, TheHive, Cortex, MISP y Security Onion.

Elementos esenciales:

### SIEM (Security Information and Event Management)

La pieza central.  
Recibe logs, los normaliza, los correlaciona y genera alertas.

Ejemplos verificables:

- Splunk
    
- Elastic SIEM
    
- QRadar
    
- Azure Sentinel
    
- Wazuh SIEM
    
- Security Onion (integración con Zeek, Suricata, Elastic)
    

### NIDS / NIPS

Sistemas de detección de intrusos en red.

- Zeek (network telemetry)
    
- Suricata (IDS/IPS)
    
- Snort (IDS/IPS)
    

Cisco relaciona esto con Firepower y su funcionamiento.

### HIDS

Sistemas de detección a nivel host:

- Wazuh agent
    
- OSSEC
    
- Sysmon para Windows (registros 4624, 4672, 7045, etc.)
    

### Threat Intelligence Platform

- MISP
    
- OpenCTI
    
- VirusTotal Intelligence
    
- Cisco Talos Intelligence
    

### Ticketing & Orquestación

- TheHive (gestión de incidentes)
    
- Cortex (análisis automatizado)
    
- Shuffle / Phantom / XSOAR (SOAR)
    

---

## 4. Flujo de trabajo dentro de un SOC (ciclo real)

Este flujo coincide con los manuales de Cisco CyberOps.

1. **Generación de alertas**  
    El SIEM detecta anomalías:  
    – intento de login fallido  
    – firma IDS  
    – hash malicioso
    
2. **Triage (Tier 1)**  
    Clasificación y priorización.  
    Determinar si es falso positivo, benigno o necesario escalar.
    
3. **Investigación (Tier 2)**  
    Búsqueda y correlación:  
    – revisar logs  
    – buscar IOCs  
    – comparar con MITRE ATT&CK  
    – analizar lateral movement (SMB, RDP)
    
4. **Respuesta (IR Team)**  
    Acciones técnicas verificables:  
    – revocar credenciales  
    – aislar host  
    – cortar tráfico  
    – limpiar malware  
    – parchar  
    – generar reportes
    
5. **Post-mortem / Contención prolongada**  
    – eliminación de persistencia  
    – cierre de brechas  
    – documentación
    
6. **Mejora continua**  
    Actualizar reglas, políticas, playbooks.
    

---

## 5. Documentos clave en un SOC

Basado en NIST 800-61 (Computer Security Incident Handling Guide).

**Plan de Respuesta a Incidentes (IRP)**  
Cómo actuar paso a paso ante cada tipo de incidente.

**Playbooks**  
Recetas operativas. Ejemplo:

- Phishing
    
- Ransomware
    
- Credential Dumping
    
- Escalación de privilegios
    
- Beaconing C2
    

**Runbooks**  
Guías detalladas para una herramienta concreta.  
Ejemplo: cómo extraer logs de Winlogbeat o cómo buscar IOC en Elastic.

**SLA / OLA**  
Tiempos máximos de respuesta por criticidad.

---

## 6. Datos que analiza un SOC (telemetría)

El SOC se alimenta de datos técnicamente verificables:

1. **Logs de red**  
    – Zeek logs  
    – Suricata EVE JSON  
    – Netflow / IPFIX  
    – Firewall logs
    
2. **Logs de host**  
    – Sysmon  
    – WinEvent Logs  
    – Auditd (Linux)
    
3. **Metadatos**  
    – Hashes (SHA256, SHA1)  
    – Dominios  
    – URLs  
    – User-agents  
    – Certificados TLS
    
4. **Eventos de autenticación**  
    – 4624, 4625, 4672 en Windows  
    – PAM logs  
    – /var/log/auth.log
    

---

## 7. Indicadores de Compromiso (IOCs) y Indicadores de Ataque (IOAs)

Cisco divide lo que se observa en:

**IOC** (pasado):  
Evidencia concreta.  
Ejemplo: hash malicioso, IP atacante.

**IOA** (presente/futuro):  
Comportamiento que indica una posible intrusión.  
Ejemplo: PowerShell ejecutando scripts codificados en Base64.

---

## 8. ¿Qué hace realmente el analista en su turno?

Una vista realista basada en SOCs operativos:

- Revisa dashboards de high-fidelity alerts
    
- Verifica si hay beaconing (contacto con C2)
    
- Analiza anomalías en NetFlow
    
- Controla autenticaciones sospechosas
    
- Busca persistencias en Windows
    
- Valida si un hash es malicioso (VirusTotal, Talos)
    
- Ejecuta consultas en el SIEM (KQL, SQL, Lucene, Elasticsearch DSL)
    
- Documenta todo en tickets
    
- Ejecuta playbooks
    
- Escala el incidente si es crítico
    
