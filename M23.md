# Módulo 23. Evaluación de Vulnerabilidades en Puntos Finales (visión SOC)

Aquí estudias:

1. Qué es una vulnerabilidad
    
2. Ciclo de vida de una vulnerabilidad
    
3. CVSS (Base, Temporal, Environmental)
    
4. Escáneres de vulnerabilidades
    
5. Evaluación de sistemas Windows y Linux
    
6. Gestión de parches
    
7. Señales SOC relacionadas
    
8. Cómo correlaciona el SIEM vulnerabilidades con ataques
    
9. Cómo priorizar riesgo
    
10. MITRE ATT&CK relacionado
    

---

# 1. ¿Qué es una vulnerabilidad?

Una vulnerabilidad es una debilidad explotable en un sistema, servicio o proceso.

Ejemplos reales:

- SMBv1 habilitado (EternalBlue MS17-010)
    
- RDP expuesto sin MFA
    
- Kernel desactualizado
    
- Powershell sin restricciones
    
- Permisos inseguros en Windows
    
- Servicios Linux con versiones antiguas
    

---

# 2. Ciclo de vida de una vulnerabilidad

1. Descubrimiento
    
2. Divulgación (responsable o no)
    
3. Asignación de CVE
    
4. Publicación en NVD
    
5. Parche del proveedor
    
6. Explotación “in the wild”
    
7. Mitigación / parcheo
    
8. Estado final (parcheado o vulnerable)
    

---

# 3. CVSS – Common Vulnerability Scoring System

CVSS es el estándar para calcular el impacto de una vulnerabilidad.

## CVSS Base Score

Evalúa características intrínsecas:

- Attack Vector (AV)
    
- Attack Complexity (AC)
    
- Privileges Required (PR)
    
- User Interaction (UI)
    
- Scope (S)
    
- Impact (C, I, A)
    

Rangos:

- 0–3.9: Bajo
    
- 4.0–6.9: Medio
    
- 7.0–8.9: Alto
    
- 9.0–10.0: Crítico
    

## CVSS Temporal

Considera:

- exploitabilidad actual
    
- madurez del exploit
    
- disponibilidad de parches
    

## CVSS Environmental

Considera tu entorno específico:

- importancia del activo
    
- exposición
    
- controles existentes
    

Verificable: https://nvd.nist.gov/cvss

---

# 4. Escáneres de vulnerabilidades

### 4.1 OpenVAS / Greenbone

Open-source. Muy usado en SOC de entrenamiento.

### 4.2 Nessus

El más extendido comercialmente.

### 4.3 Qualys

Escaneo continuo en nube.

### 4.4 Microsoft Defender Vulnerability Management

Para endpoints Windows corporativos.

### 4.5 Lynis (Linux)

Auditoría de seguridad en Linux.

### 4.6 Nikto (web)

Identifica problemas en servidores web.

### 4.7 Nmap NSE scripts

Escanea servicios específicos con scripts.

---

# 5. Evaluación de Windows

Vulnerabilidades comunes:

- SMBv1 habilitado
    
- RDP sin MFA
    
- Servicios con permisos inseguros
    
- Versiones de Windows sin soporte
    
- Powershell sin restricciones
    
- Software desactualizado
    
- Claves de registro débiles
    
- DLL hijacking
    

Herramientas:

- Nessus / OpenVAS
    
- Defender Vulnerability Management
    
- PowerShell SecBaseline
    
- SysInternals (autoruns, accesschk)
    

---

# 6. Evaluación de Linux

Vulnerabilidades comunes:

- Kernel antiguo
    
- Servicios expuestos innecesarios
    
- Paquetes sin actualizar
    
- SSH sin hardening
    
- Permisos inseguros
    
- Cron jobs mal configurados
    
- Configuración sudo débil
    

Herramientas:

- Lynis
    
- OpenVAS
    
- Nmap NSE
    
- auditd
    
- CIS Benchmarks
    

---

# 7. Gestión de parches (Patch Management)

Ciclo:

1. Inventario de activos
    
2. Identificación de vulnerabilidades
    
3. Evaluación de impacto
    
4. Priorización (CVSS + impacto real)
    
5. Pruebas en entorno seguro
    
6. Aplicar parche
    
7. Verificar
    
8. Documentar
    

Señales SOC de parcheo fallido:

- hosts con la misma vulnerabilidad mes tras mes
    
- explotación de vulnerabilidades conocidas (CVE)
    
- versiones antiguas de servicios
    

---

# 8. Correlación SOC entre vulnerabilidades y ataques

El SOC debe correlacionar:

1. Vulnerabilidad detectada
    
2. Tráfico sospechoso
    
3. Intentos de explotación
    

Ejemplo real:

- OpenVAS detecta MS17-010 → SMBv1
    
- Suricata detecta “ET EXPLOIT ETERNALBLUE”
    
- SIEM correlaciona → alerta crítica
    
- Endpoint muestra crash de svchost.exe
    

Esto permite **detener el ataque antes de que cause daño**.

---

# 9. Señales SOC relacionadas con vulnerabilidades

|Señal|Interpretación|
|---|---|
|Tráfico hacia servicio no parcheado|explotación en curso|
|Escaneo de puertos vulnerables|reconocimiento activo|
|Tráfico malformado|intento de exploit|
|Comportamiento extraño|explotación exitosa|
|Fallos repetidos del servicio|crash provocado por exploit|
|Elevación de privilegios|explotación post-intrusión|

---

# 10. Explotación de vulnerabilidades (cómo la ve el SOC)

Ejemplos de explotación visible:

### Exploit SMB

- conn.log con “SMB error”
    
- Suricata con alertas “ET EXPLOIT EternalBlue”
    

### Exploit Web

- HTTP requests con payload
    
- 500/403 repetidos
    
- payload SQL/XSS
    

### Exploit Kernel

- crash repentino del host
    
- procesos root sin explicación
    

### Exploit de RDP/SSH

- logs con credenciales válidas + actividad anomala
    
- reinicios sospechosos
    

---

# 11. Priorizar vulnerabilidades

Factores:

- CVSS
    
- si hay exploit público
    
- si está siendo explotada en la naturaleza (Talos, CISA KEV)
    
- criticidad del activo
    
- exposición a Internet
    
- facilidad de explotación
    

---

# 12. Herramientas de análisis manual

### Para Windows:

- sysinternals suite
    
- powershell baselines
    
- registry auditing
    

### Para Linux:

- lynis
    
- chkrootkit
    
- rkhunter
    
- auditctl
    

---

# 13. MITRE ATT&CK asociado

- **T1190 – Exploit Public-Facing Application**
    
- **T1588 – Obtain Capabilities**
    
- **T1068 – Privilege Escalation via Kernel Exploit**
    
- **T1210 – Exploitation of Remote Services**
    
- **T1134 – Access Token Manipulation**
    
- **T1574 – DLL Search Order Hijacking**
    

---

# 14. ¿Qué debe dominar un analista al terminar este módulo?

- Entender CVE y CVSS
    
- Leer reportes de OpenVAS/Nessus
    
- Priorizar vulnerabilidades
    
- Evaluar riesgos en endpoints Windows/Linux
    
- Correlacionar intentos de explotación con vulnerabilidades detectadas
    
- Reconocer señales de exploit
    
- Saber interpretar parches aplicados vs pendientes
    
- Entender diferencias entre vulnerabilidad explotable y no explotable
    
- Integrar gestión de vulnerabilidades con SOC