# Módulo 17. Ataques a los Servicios (visión SOC)

Este módulo describe:

- Cómo funcionan los ataques contra servicios
    
- Qué herramientas usan los atacantes
    
- Qué logs se generan
    
- Qué señales detecta un SOC
    
- Cómo correlacionarlo en un SIEM
    
- Qué técnica MITRE corresponde
    

Vamos servicio por servicio, desde los más atacados.

---

# 1. Ataques contra HTTP / HTTPS (Web)

Este es el terreno más fértil para atacantes.

### 1.1 SQL Injection (SQLi)

El atacante inyecta código SQL en parámetros de entrada.

Señales SOC:

- URLs con `' OR 1=1 --`
    
- Consultas con palabras clave SQL
    
- Respuestas HTTP 500 o 200 inusuales
    
- Payloads en parámetros GET/POST
    
- Aumento de consultas en la base de datos
    

MITRE: **T1190, T1505, T1059**

### 1.2 Cross-Site Scripting (XSS)

Inyección de JavaScript en sitios web.

Señales:

- Parámetros con `<script>`
    
- URLs con `%3Cscript%3E`
    
- Cambios en cookies
    
- User-agents inusuales
    

### 1.3 Directory Traversal

Acceso a archivos fuera del directorio permitido.

- `../etc/passwd`
    
- `/../../../../windows/system32`
    

### 1.4 Webshells

El atacante sube un archivo PHP/ASPX que ejecuta comandos.

Señales:

- Archivos nuevos en `/uploads`
    
- Peticiones POST sospechosas
    
- Process create anómalo
    

### 1.5 RFI/LFI (Remote/Local File Inclusion)

Señales:

- URLs que cargan código remoto
    
- Respuestas grandes y anómalas
    

### Logs web relevantes:

- access.log
    
- error.log
    
- Zeek: http.log, mime types, file extraction
    
- Suricata: ET WEB_SERVER rules
    

---

# 2. Ataques contra DNS

### 2.1 DNS Tunneling

Método de exfiltración o C2.

Señales:

- Consultas TXT muy largas
    
- Dominios aleatorios (DGA)
    
- Mucha frecuencia hacia un dominio
    
- NXDOMAIN repetidos
    

MITRE: **T1071.004**

### 2.2 DNS Poisoning

Manipulación de respuestas DNS.

Señales SOC:

- Respuestas desde IP no autorizada
    
- TTL extremadamente bajo
    
- Respuestas inconsistentes
    

---

# 3. Ataques contra SMB (Windows)

SMB es uno de los servicios más explotados en historia moderna.

### 3.1 EternalBlue (MS17-010)

Señal detectable en IDS:

- “ET EXPLOIT Possible ETERNALBLUE”
    

### 3.2 SMB Relay

Reenvío de credenciales NTLM.

### 3.3 Pass-the-Hash / Pass-the-Ticket

Uso de hash/cookies para acceso.

Logs SOC:

- 4624 tipo 3 (logon de red)
    
- 4648 uso de credenciales explícitas
    
- Conexiones SMB entre hosts inesperados
    

MITRE: **T1021.002**

---

# 4. Ataques contra SSH

### Tipos:

- Fuerza bruta
    
- Uso de claves robadas
    
- Túneles SSH invertidos
    
- Explotación de configuraciones débiles
    

Señales SOC:

- “Failed password” repetido
    
- Conexiones desde países inesperados
    
- Conexiones en horarios extraños
    
- Uso de puertos no estándar (2222, 2022)
    
- Sesiones largas sin actividad
    

MITRE: **T1021.004**

---

# 5. Ataques contra RDP

RDP es uno de los vectores favoritos.

Ataques:

- Fuerza bruta
    
- RDP Hijacking
    
- Credenciales comprometidas
    
- Exposición del servicio a Internet
    

Señales SOC:

- Conexiones repetidas en 3389
    
- Logon 4625 repetidos
    
- Conexiones desde países o IPs públicas nuevas
    
- Sesiones largas y sin interacción
    

MITRE: **T1563.002**

---

# 6. Ataques contra FTP

FTP es inseguro por naturaleza.

Ataques:

- Credential harvesting
    
- Directory traversal
    
- Man-in-the-middle
    
- Subida de archivos maliciosos
    

Señales SOC:

- Conexiones desde clientes no autorizados
    
- Muchos fallos de login
    
- Descargas masivas
    
- Archivos inesperados
    

---

# 7. Ataques contra SMTP (correo)

Ataques:

- Phishing
    
- Malware adjunto
    
- Spoofing
    
- Compromiso de cuentas (BEC)
    

Señales SOC:

- Mensajes salientes excesivos
    
- Adjuntos ejecutables
    
- Cambios en SPF/DKIM
    
- Conexiones SMTP desde hosts internos que no deberían enviar correo
    

---

# 8. Ataques contra NTP

Ataques:

- Amplificación
    
- Manipulación del tiempo
    
- Respuestas exageradamente grandes
    

Señales:

- PPS anormal
    
- Tráfico excesivo al puerto 123
    

---

# 9. Exfiltración de datos a través de servicios

### HTTP/HTTPS

- POST grandes
    
- Sesiones largas
    
- Sin SNI
    
- Certificados raros
    

### DNS

- TXT largos
    
- Dominios DGA
    

### SMB

- Transferencias grandes
    
- Copias sospechosas
    

### SSH/SFTP

- Túneles cifrados
    
- Uploads inesperados
    

---

# 10. Movimiento lateral usando servicios

### SMB

### WMI

### WinRM

### RDP

### SSH

Señales:

- Varios hosts recibiendo conexiones del mismo origen
    
- Autenticaciones sucesivas con mismo usuario
    
- 4624 + 4672 en cadena
    

---

# 11. Herramientas ofensivas por servicio

### Web

- Burp Suite
    
- SQLmap
    
- wfuzz
    
- dirbuster
    

### SMB

- Impacket suite
    
- CrackMapExec
    

### SSH

- Hydra
    
- Metasploit auxiliary
    
- SSH private key attacks
    

### DNS

- iodine
    
- dnscat2
    

### RDP

- xfreerdp
    
- crowbar
    
- ncrack
    

---

# 12. MITRE ATT&CK relacionado

- **T1190 – Exploit Public-Facing Application**
    
- **T1071 – Application Layer Protocol**
    
- **T1021 – Remote Services**
    
- **T1003 – Credential Dumping**
    
- **T1041 – Exfiltration Over C2 Channel**
    
- **T1566 – Phishing**
    
- **T1059 – Execution**
    
- **T1485 – Data Destruction**
    
- **T1222 – Permission Modification**
    

---

# 13. ¿Qué debe dominar un analista al terminar este módulo?

- Reconocer explotación de servicios por sus señales
    
- Detectar anomalías en HTTP, SMB, RDP, SSH, DNS
    
- Relacionar artefactos web con OWASP y MITRE
    
- Detectar C2 oculto en servicios normales
    
- Analizar SMB lateral movement
    
- Ver exfiltración en tráfico lógico
    
- Interpretar logs de web, DNS, SMB, SSH
    
- Asociar herramientas ofensivas con patrones
    
- Priorizar alertas basadas en impacto
    
- Distinguir ruido de actividad maliciosa real