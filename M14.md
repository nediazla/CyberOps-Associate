# Módulo 14. Amenazas y Ataques Comunes (visión SOC)

Este módulo trata las categorías principales de ataques:

1. Ataques de ingeniería social
    
2. Ataques de red
    
3. Ataques a servicios
    
4. Ataques al endpoint
    
5. Malware
    
6. Ransomware
    
7. MITM
    
8. Phishing y variantes
    
9. DDoS
    
10. Ataques web (OWASP Top 10)
    
11. Exfiltración de datos
    
12. Movimiento lateral
    

---

# 1. Ingeniería social

### Formas:

- Phishing
    
- Spear phishing
    
- Whaling
    
- Vishing
    
- Smishing
    

### Señales SOC:

- Emails con dominios recién creados
    
- Adjuntos sospechosos
    
- URLs ofuscadas
    
- Correo desde direcciones que “se parecen” a legítimas
    
- Conexiones HTTP/HTTPS hacia dominios raros justo después de abrir un email
    

Logs:

- SMTP logs (sender, subject, attachments)
    
- Proxy logs (URL, user-agent)
    

---

# 2. Ataques de red

### 2.1 Escaneo (Reconnaissance)

Herramientas: Nmap, Masscan, Zmap  
Señales:

- SYN sin completar handshake
    
- FIN/XMAS/NULL scans
    
- Many ICMP echo requests
    

### 2.2 Spoofing

- ARP spoofing
    
- IP spoofing  
    Señales:
    
- Cambios de ARP
    
- TTL inconsistentes
    

### 2.3 Sniffing (captura de tráfico)

- MITM
    
- ARP poisoning
    

### 2.4 DoS/DDoS

Tipos:

- SYN flood
    
- UDP flood
    
- ICMP flood
    
- Amplificación DNS/NTP/Memcached  
    Señales:
    
- TTL inusual
    
- Conexiones semiabiertas
    
- altísimo PPS (packets per second)
    

---

# 3. Ataques a servicios (los más frecuentes en un SOC)

### 3.1 SSH brute force

Señales:

- Muchos 4625 (Windows)
    
- Muchos “Failed password” (Linux)
    
- Conexiones desde países inesperados
    

### 3.2 RDP brute force

Señales:

- Intentos masivos en port 3389
    
- Conexiones desde IPs nuevas
    
- Logins con privilegios
    

### 3.3 SMB exploits

- EternalBlue
    
- SMB relay
    
- Pass-the-Hash  
    Señales:
    
- Conexiones SMB entre hosts que no deben
    
- 4624 + 4672
    
- Mapeo de shares extraño
    

### 3.4 SQL brute force / SQLi

Señales:

- SQL patterns en URLs (“UNION SELECT”, “‘ OR 1=1”)
    
- Respuestas HTTP 500
    
- Consultas excesivamente largas
    

---

# 4. Ataques al endpoint

### 4.1 Malware clásico

Tipos:

- Gusanos
    
- Troyanos
    
- Backdoors
    
- Keyloggers
    

Señales:

- Procesos anómalos
    
- Cambios en registro
    
- Conexiones persistentes a IP de C2
    
- Creación de archivos en AppData
    

### 4.2 Ransomware

Confirmado por múltiples informes (Talos, CrowdStrike, Mandiant).

Fases:

1. Acceso inicial (phishing, RDP, exploit)
    
2. Movimiento lateral
    
3. Enumeración de red
    
4. Exfiltración
    
5. Cifrado
    

Señales SOC:

- Masivos 4624
    
- Escritura en muchas carpetas en muy poco tiempo
    
- Extensiones nuevas en archivos
    
- Creación de claves Run/RunOnce
    
- Beaconing a Tor/C2
    

---

# 5. Ataques web (OWASP Top 10)

### 5.1 SQL Injection

Señales:

- “' OR 1=1”
    
- Respuestas HTTP 500
    
- Patrones de enumeración en URLs
    

### 5.2 XSS

Señales:

- Scripts en parámetros GET/POST
    
- URL con caracteres escapados
    

### 5.3 CSRF

- Cambios no autorizados en formularios
    

### 5.4 File Upload Attack

- Subida de webshells  
    Señales:
    
- Archivos PHP en /uploads
    
- Tráfico HTTP ejecutando comandos
    

---

# 6. MITM (Man-in-the-Middle)

### Métodos:

- ARP poisoning
    
- DNS poisoning
    
- Evil Twin
    
- Rogue AP
    
- SSL stripping
    

Señales SOC:

- ARP replies no solicitados
    
- Certificados TLS cambiando repentinamente
    
- Tráfico hacia servidores DNS inesperados
    
- Cambios en gateway detectado
    

---

# 7. Exfiltración de datos

### Métodos:

- DNS tunneling
    
- HTTPS hacia dominio único
    
- FTP/SFTP
    
- Cloud storage no autorizado
    

Señales:

- DNS TXT con payload grande
    
- HTTP POST enorme
    
- Conexiones constantes e idénticas (C2 beaconing)
    
- Subida masiva de archivos
    

---

# 8. Movimiento lateral

### Métodos:

- SMB
    
- WMI
    
- PsExec
    
- WinRM
    
- RDP
    
- SSH lateral
    

Señales:

- Muchas conexiones SMB
    
- Autenticaciones sucesivas en varios hosts
    
- 4624/4672 combinados
    
- RDP fuera de horario
    

---

# 9. Elevación de privilegios

### Métodos:

- UAC bypass
    
- kernel exploits
    
- token impersonation
    
- sudo/su abuse (Linux)
    

Señales:

- Nuevo grupo administrador
    
- Nueva entrada sudoers
    
- Proceso accediendo a LSASS
    
- Ejecución con privilegios elevados
    

---

# 10. Persistencia

### Métodos:

- Tareas programadas
    
- Run/RunOnce
    
- Servicios nuevos
    
- DLL hijacking
    
- Webshells
    
- Cron jobs (Linux)
    
- SSH authorized_keys
    

Señales:

- Eventos 7045
    
- Nuevas entradas en cron
    
- Cambios en ~/.ssh/authorized_keys
    

---

# 11. Técnicas MITRE relacionadas

- **T1566 – Phishing**
    
- **T1040 – Sniffing**
    
- **T1498 – Network DoS**
    
- **T1071 – C2**
    
- **T1059 – Execution**
    
- **T1003 – Credential Dumping**
    
- **T1021 – Remote Services**
    
- **T1041 – Exfiltration**
    
- **T1053 – Scheduled Tasks**
    
- **T1036 – Masquerading**
    

---

# 12. ¿Qué debe saber un analista después de este módulo?

- Reconocer patrones de ataques reales
    
- Detectar señales de ransomware, phishing, exploits
    
- Diferenciar tráfico normal de comportamiento malicioso
    
- Entender fases del ataque
    
- Ver cómo cada técnica aparece en logs
    
- Interpretar C2, exfiltración, movimiento lateral
    
- Correlacionar señales con MITRE ATT&CK
    
- Determinar severidad e impacto