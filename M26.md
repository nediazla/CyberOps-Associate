# Módulo 26. Evaluación de Alertas (visión SOC)

El objetivo del módulo es enseñar:

1. Qué es una alerta
    
2. Cómo se evalúa (triage)
    
3. Cómo se clasifica (benigna, sospechosa, maliciosa)
    
4. Cómo se valida
    
5. Cómo se investiga
    
6. Cómo se prioriza
    
7. Cómo se escala a N2/N3
    
8. Cómo se documenta
    
9. Cómo evitar falsos positivos
    

---

# 1. ¿Qué es una alerta?

Una alerta es un evento que el sistema de detección identifica como potencialmente malicioso o anómalo.

Puede venir de:

- SIEM
    
- EDR
    
- Firewall
    
- IDS/IPS
    
- Proxy
    
- DNS security
    
- WAF
    
- NAC
    
- MDM
    

Una alerta no siempre significa ataque.  
El trabajo del SOC es separar señales reales del ruido.

---

# 2. Fases del análisis de alertas

Cisco CyberOps divide el proceso en:

1. **Recepción**
    
2. **Triage inicial (N1)**
    
3. **Validación (N1/N2)**
    
4. **Investigación (N2)**
    
5. **Clasificación**
    
6. **Acción / Respuesta**
    
7. **Escalado si aplica**
    
8. **Documentación**
    

Vamos con cada una.

---

# 3. Triage inicial (Nivel 1)

El analista N1 debe responder rápidamente:

- ¿La alerta es real?
    
- ¿Qué la generó?
    
- ¿Es importante?
    
- ¿Afecta un activo crítico?
    
- ¿Es ruido/falso positivo?
    
- ¿Necesita investigación?
    

Datos necesarios:

- usuario
    
- IP origen y destino
    
- dispositivo afectado
    
- reglas activadas
    
- timestamp
    
- contexto (VLAN, país, rol, servicio)
    

En muchos SOC, un N1 tiene entre 2 y 5 minutos por alerta.

---

# 4. Validación (N1/N2)

Pasos para validar:

1. Revisar logs relacionados
    
2. Revisar reputación de IP/dominio
    
3. Revisar proceso (si viene de EDR)
    
4. Revisar historial del host
    
5. Ver si es actividad legítima
    
6. Revisar si la alerta coincide con un patrón MITRE
    

Si pasa esta fase → se investiga.  
Si no → se descarta (como falso positivo).

---

# 5. Investigación (Nivel 2)

Los analistas N2 profundizan:

- ¿Qué proceso generó el evento?
    
- ¿Qué usuario estaba logueado?
    
- ¿Qué cambios se hicieron?
    
- ¿Qué tráfico hubo antes y después?
    
- ¿Hay otros hosts afectados?
    
- ¿Se puede correlacionar con otras alertas?
    
- ¿Hay exfiltración?
    
- ¿Hay lateral movement?
    

Fuentes consultadas:

- SIEM (búsquedas avanzadas)
    
- EDR (árbol de procesos)
    
- proxy logs
    
- DNS logs
    
- firewall logs
    
- netflow
    
- PCAP
    
- Threat intelligence
    

---

# 6. Clasificación de alertas

## 6.1 Benigna

- Actividad normal
    
- Comportamiento esperado
    
- Servicio legítimo
    
- Técnicos haciendo mantenimiento
    

## 6.2 Sospechosa

- No se puede confirmar malicia
    
- Comportamiento extraño pero plausible
    
- Definir watchlist o monitoreo
    

## 6.3 Maliciosa

- Coincide con IOC/IOA
    
- Correspondencia MITRE
    
- Procesos maliciosos
    
- Conexiones C2
    
- Explotación clara
    
- Persistencia detectada
    

---

# 7. Priorización (Severity)

Factores:

1. **Impacto**
    
    - ¿Puede afectar datos críticos?
        
    - ¿Puede comprometer varios hosts?
        
2. **Probabilidad**
    
    - ¿Hay explotación activa?
        
    - ¿Hay malware ejecutándose?
        
3. **Exposición del activo**
    
    - ¿Es servidor crítico?
        
    - ¿Es un usuario administrador?
        
4. **Tipo de ataque**
    
    - ransomware = crítico
        
    - brute force = medio
        
    - scanning = bajo
        

---

# 8. Acción / Respuesta

Dependiendo del análisis:

### Si la alerta es maliciosa:

- Aislar host (EDR)
    
- Bloquear IP/dominio
    
- Reset de contraseñas
    
- Revocar tokens
    
- Parchear vulnerabilidad
    
- Escalar a IR (Incident Response)
    
- Extraer muestras de malware
    

### Si es sospechosa:

- Monitorizar
    
- Crear regla nueva
    
- Ajustar alerta
    

### Si es benigna:

- Cerrar evento
    
- Documentar por qué
    
- Ajustar reglas si produce ruido
    

---

# 9. Escalado

El proceso típico:

- N1 → N2 (si sospechosa/maliciosa)
    
- N2 → N3 (si es compleja o forense)
    
- N3 → IR/Threat Hunting (si hay campaña activa)
    

---

# 10. Documentación

El analista debe dejar registro de:

- qué pasó
    
- qué evidencia revisó
    
- qué decisión tomó
    
- qué acción ejecutó
    
- qué recomendaciones deja
    

Documentación precisa es clave en forense.

---

# 11. Ejemplos de alertas y análisis (reales)

## 11.1 Ejemplo 1: Fuerza bruta SSH

- 20.000 intentos fallidos
    
- EventID en Linux: /var/log/auth.log
    
- Flow: conexiones repetidas  
    → clasificación: **medio**  
    → respuesta: bloquear IP, analizar origen
    

## 11.2 Ejemplo 2: Powershell codificado

- logs 4104
    
- árbol: winword.exe → powershell  
    → clasificación: **crítico**  
    → acción: aislar host
    

## 11.3 Ejemplo 3: DNS TXT largos

- indicador de tunneling  
    → clasificación: **alto**  
    → acción: bloquear dominio, investigar host
    

---

# 12. MITRE ATT&CK relacionado

- **T1078 – Valid Accounts**
    
- **T1059 – Command Execution**
    
- **T1547 – Persistence**
    
- **T1566 – Phishing**
    
- **T1041 – Exfiltration**
    
- **T1021 – Remote Services**
    
- **T1083 – File Discovery**
    
- **T1036 – Masquerading**
    
- **T1040 – Network Sniffing**
    
- **T1204 – User Execution**
    

---

# 13. ¿Qué debe dominar un analista al terminar este módulo?

- Leer, validar y clasificar alertas
    
- Priorizar impacto vs probabilidad
    
- Reconocer patrones maliciosos
    
- Distinguir falso positivo vs actividad real
    
- Investigar con SIEM, EDR, Flow, DNS, firewall
    
- Correlacionar eventos
    
- Documentar correctamente
    
- Escalar según necesidad
    
- Tomar decisiones rápidas y basadas en evidencia
    
- Ejecutar acciones de respuesta inmediatas