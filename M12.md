# Módulo 12. Infraestructura de Seguridad de Red (visión SOC)

Aquí vemos:

1. Dispositivos de seguridad
    
2. Arquitecturas defensivas
    
3. NGFW, IPS, WAF, Proxy
    
4. Zero Trust
    
5. NAC (Network Access Control)
    
6. VPN y acceso remoto
    
7. Detección SOC sobre cada uno
    
8. Señales de ataque
    
9. MITRE asociado
    

Es uno de los módulos más importantes del examen.

---

# 1. Firewalls (el pilar clásico)

### Tipos:

**1.1 Firewalls tradicionales (L3/L4)**

- Filtran por IP, puerto, protocolo.
    
- Útiles pero fácilmente evadibles.
    

**1.2 Firewalls con estado (stateful)**

- Mantienen tabla de conexiones.
    
- Permiten detectar paquetes fuera de estado.
    
- Cisco ASA, Cisco Zone-Based Firewall.
    

**1.3 Next-Generation Firewalls (NGFW)**  
Incluyen inspección profunda (DPI), IPS, control de aplicaciones, anti-malware, URL filtering.

Ejemplos:

- Cisco Firepower
    
- Palo Alto
    
- FortiGate
    

### Señales SOC:

- Conexiones bloqueadas repetidamente (scans).
    
- Carga anormal en motor de inspección.
    
- Aplicaciones no permitidas detectadas.
    
- Regla cambiada o añadida sin autorización.
    
- Tráfico C2 detectado mediante inspección TLS.
    

### Logs:

- Connection events
    
- Threat logs
    
- Malware logs
    
- URL filtering logs
    
- Policy change logs
    

---

# 2. IDS / IPS

**IDS (Intrusion Detection System)**  
Detecta actividades maliciosas.

**IPS (Intrusion Prevention System)**  
Detecta y bloquea.

Ejemplos:

- Snort
    
- Suricata
    
- Zeek (más análisis que bloqueo)
    
- Cisco Firepower IPS
    

### Qué detecta:

- Escaneos
    
- Brute force
    
- SQLi / XSS
    
- Ataques a protocolos
    
- Exploits conocidos
    
- C2
    
- Evasión (fragmentación, payloads alterados)
    

### Señales SOC:

- “ET SCAN”
    
- “ET WEB_SERVER”
    
- “ET CNC”
    
- “SURICATA HTTP unusual user-agent”
    

Todo verificable en reglas Emerging Threats (ET).

---

# 3. WAF (Web Application Firewall)

Protege aplicaciones web (HTTP/HTTPS).

Ejemplos:

- ModSecurity
    
- F5 ASM
    
- FortiWeb
    

Protege contra:

- SQL Injection
    
- XSS
    
- CSRF
    
- Path Traversal
    
- Command Injection
    
- File Upload malicioso
    

### Señales SOC:

- Bloqueos repetidos de ciertas IPs
    
- URLs largas o con caracteres escapados
    
- Payloads de SQL
    
- Intentos de leer /etc/passwd
    
- Subidas de archivos extraños
    

---

# 4. Proxies (HTTP/HTTPS)

Analizan, filtran y registran tráfico web.

Ejemplos:

- Squid
    
- Zscaler
    
- Blue Coat
    
- Cisco Umbrella Secure Web Gateway
    

### Señales SOC:

- User-Agents sospechosos
    
- Conexiones constantes a un dominio único (C2)
    
- Dominios recién creados o mal reputados
    
- Túneles CONNECT hacia IPs no estándar
    
- Descargas de ejecutables sin contexto
    

---

# 5. Anti-Malware / EDR / XDR

Los antivirus tradicionales no bastan.  
Hoy se usa:

- EPP (Endpoint Protection Platform)
    
- EDR (Endpoint Detection & Response)
    
- XDR (Extended Detection & Response)
    

Ejemplos:

- Cisco AMP for Endpoints
    
- CrowdStrike Falcon
    
- Defender for Endpoint
    
- SentinelOne
    
- Wazuh + Sysmon
    

### Señales SOC:

- Hash malicioso detectado
    
- Ejecución de PowerShell codificado
    
- Acceso a LSASS (credential dumping)
    
- Procesos hijos sospechosos (winword.exe → cmd.exe)
    
- Persistencia añadida
    

---

# 6. VPN y acceso remoto

VPN segura:

- IPsec
    
- SSL VPN
    
- Cisco AnyConnect
    

### Señales SOC:

- Conexiones desde países nuevos
    
- Cambios frecuentes de IP
    
- Sesiones largas sin actividad
    
- Múltiples fallos de autenticación
    
- Certificados no autorizados
    

Logs:

- IKE logs
    
- Authentication logs
    
- Syslog del concentrador
    

---

# 7. NAC (Network Access Control)

Controla qué dispositivos acceden a la red.

Ejemplos:

- Cisco ISE
    
- Aruba ClearPass
    

### Funciona con:

- 802.1X
    
- MAB (MAC Authentication Bypass)
    
- Profiling
    
- Posture assessment
    

### Señales SOC:

- Dispositivo no autorizado intentando entrar
    
- Fallos de 802.1X
    
- Cambios de identidad/rol del usuario
    
- Suplantación de MAC
    

---

# 8. Zero Trust (NIST 800-207)

Zero Trust elimina la confianza implícita.  
Todo acceso debe verificarse constantemente.

### Principios:

- Validar identidad continuamente
    
- Autorización por contexto
    
- Microsegmentación
    
- Mínimo privilegio
    
- Monitoreo constante
    

### Señales SOC:

- Cambios de comportamiento en usuarios
    
- Acceso a recursos no habituales
    
- Aumento de autenticaciones fallidas
    
- Tráfico lateral inesperado
    

---

# 9. Sandboxing

Entornos seguros donde se ejecutan archivos sospechosos.

Ejemplos:

- Cisco Threat Grid
    
- FireEye
    
- CrowdStrike sandbox
    

Señales:

- Comportamiento malicioso detectado
    
- C2 callbacks
    
- Modificaciones del registro
    
- Creación de archivos sospechosos
    

---

# 10. DLP (Data Loss Prevention)

Evita fuga de información.

### Señales SOC:

- Envío de archivos confidenciales
    
- Exfiltración vía DNS
    
- Archivos cifrados sin contexto
    
- Uso de servicios cloud no autorizados
    

---

# 11. Correlación de seguridad (SIEM)

El SIEM une todos los dispositivos:

- Firewall → bloquea
    
- IDS → detecta
    
- EDR → alerta
    
- DNS → consulta
    
- Proxy → filtra
    
- VPN → autentica
    
- NAC → controla acceso
    
- WAF → protege aplicación
    

El SOC correlaciona señales como:

- DNS extraño + Beaconing
    
- SMB lateral + RDP inesperado
    
- Cambios de ARP + tráfico duplicado
    
- Fallos SSH + intentos VPN
    
- Ejecución PowerShell + descarga HTTP
    

---

# 12. MITRE ATT&CK asociado

Técnicas comunes:

- **T1190 – Exploit Public-Facing Application**
    
- **T1046 – Network Scanning**
    
- **T1498 – Network DoS**
    
- **T1557 – Man-in-the-Middle**
    
- **T1071 – Application Layer Protocol**
    
- **T1059 – Command Execution**
    
- **T1562 – Defense Evasion**
    
- **T1021 – Remote Services**
    
- **T1568 – Exfiltration Over TLS**
    

---

# 13. ¿Qué debe saber el analista al terminar este módulo?

- Interpretar logs de firewall, IPS, WAF, proxy y VPN
    
- Detectar errores de configuración vs ataques
    
- Analizar actividad sospechosa en Zero Trust
    
- Correlacionar señales entre múltiples dispositivos
    
- Identificar exfiltración
    
- Detectar tunneling
    
- Reconocer C2
    
- Validar si reglas de seguridad funcionan
    
- Interpretar telemetría de múltiples capas