# Módulo 18. Comprensión de la Defensa (visión SOC)

El objetivo es entender:

1. Cómo funciona la arquitectura de seguridad
    
2. Cómo se implementa la defensa en profundidad
    
3. Cómo operan los controles preventivos, detectivos y correctivos
    
4. Cómo responde una organización a incidentes
    
5. Cómo se correlaciona todo lo que ve un SOC
    

Este módulo une procesos con tecnología.

---

# 1. Defensa en profundidad

Concepto fundamental: múltiples capas de defensa.

Capas típicas:

- Física
    
- Red
    
- Transporte
    
- Aplicación
    
- Endpoint
    
- Identidad
    
- Data
    
- Monitoreo
    

La idea es que **un fallo no comprometa la organización completa**.

Ejemplo verificable:  
Si alguien evade el firewall, el IDS/IPS, EDR, reservas de autenticación o el SIEM pueden detectarlo.

---

# 2. Arquitectura de seguridad moderna

### Componentes fundamentales:

- Firewalls (tradicionales o NGFW)
    
- IDS/IPS
    
- WAF
    
- Proxies
    
- VPN concentrators
    
- NAC (Cisco ISE)
    
- DNS security
    
- Endpoint Security (EDR/XDR)
    
- SIEM (correlación)
    
- SOAR (automatización)
    
- Sandboxes
    

### ¿Qué debe comprender un analista SOC?

- Dónde está cada control
    
- Qué protege
    
- Qué log genera
    
- Qué hace cada control cuando falla
    

Ejemplo:

- Firewall bloquea → IDS detecta → SIEM correlaciona → analista responde → SOAR ejecuta acciones.
    

---

# 3. Modelo Zero Trust (NIST 800-207)

Zero Trust elimina la confianza implícita.

### Principios:

- **Nunca confíes, verifica siempre**
    
- Acceso basado en identidad y contexto
    
- Microsegmentación
    
- Mínimo privilegio
    
- Validación continua
    
- Telemetría constante
    

### Señales:

- Acceso anómalo
    
- Cambios de device posture
    
- Flujos inesperados
    
- Autenticaciones sospechosas
    

---

# 4. Controles preventivos, detectivos y correctivos

### Preventivos:

- Firewall
    
- NAC
    
- MFA
    
- Hardening
    
- Patching
    
- Segmentación
    

### Detectivos:

- IDS/IPS
    
- SIEM
    
- EDR
    
- Honeypots
    
- Network flow analysis
    

### Correctivos:

- SOAR (bloqueo automático)
    
- Respuesta a incidentes
    
- Rotación de credenciales
    
- Parcheo urgente
    

---

# 5. Ciclo de vida de la seguridad (NIST Cybersecurity Framework)

Cinco funciones:

1. **Identify** – inventarios de activos, análisis de riesgo
    
2. **Protect** – controles preventivos
    
3. **Detect** – SIEM, IDS, monitoreo
    
4. **Respond** – contención, erradicación, acciones
    
5. **Recover** – restauración y mejoras
    

El analista SOC trabaja principalmente en **Detect** y **Respond**, con impacto en **Recover**.

---

# 6. El rol del SOC: niveles y funciones

### Nivel 1 (Monitoring & Triage)

- Ver alertas
    
- Filtrar falso positivo
    
- Clasificar severidad
    
- Enviar a Nivel 2
    

### Nivel 2 (Analysis & Investigation)

- Análisis profundo
    
- Consultar logs históricos
    
- Validar ataque
    
- Contención manual
    

### Nivel 3 (Threat Hunting / Forensics)

- Cazar amenazas sin alerta previa
    
- Análisis forense
    
- Evaluación de nuevas TTPs
    
- Ajuste de reglas
    

---

# 7. Proceso de respuesta a incidentes (NIST 800-61)

Fases:

1. **Preparación**
    
    - Playbooks
        
    - Herramientas
        
    - Backups
        
2. **Identificación**
    
    - Detección inicial
        
    - Clasificación
        
3. **Contención**
    
    - Aislar host
        
    - Bloquear IP
        
    - Revocar credenciales
        
4. **Erradicación**
    
    - Eliminar malware
        
    - Parcheo
        
5. **Recuperación**
    
    - Restaurar servicios
        
    - Validar funcionamiento
        
6. **Lecciones aprendidas**
    
    - Ajustar detecciones
        
    - Mejorar defensas
        

---

# 8. Telemetría como pilar de defensa

### Fuentes clave:

- Flow (NetFlow/IPFIX)
    
- Logs de firewall
    
- DNS logs
    
- SIEM
    
- EDR/XDR
    
- Active Directory
    
- Syslog
    
- Proxy logs
    
- IDS/IPS
    

La defensa moderna se basa en **ver todo lo posible**.

---

# 9. Inteligencia de amenazas (Threat Intelligence)

Tipos:

- **IOCs** (Indicators of Compromise)
    
    - IP maliciosa
        
    - HASH de malware
        
    - Dominio malicioso
        
- **TTPs** (Tactics, Techniques, Procedures)
    
    - MITRE ATT&CK
        
- **IOAs** (Indicators of Attack)
    
    - Comportamiento sospechoso
        

Fuentes verificables:

- Cisco Talos
    
- MISP
    
- AlienVault OTX
    
- VirusTotal
    
- Unit42
    

---

# 10. Hardenización (Hardening)

Acciones de endurecimiento:

- Deshabilitar servicios innecesarios
    
- Restringir puertos
    
- Actualizar software
    
- Aplicar MFA
    
- Limitar privilegios
    
- Asegurar configuración SSH/RDP
    
- Configurar contraseñas fuertes
    
- Aislar redes sensibles
    

### Señales SOC de fallo en hardening:

- uso de versiones antiguas
    
- credenciales débiles
    
- servicios expuestos
    
- configuraciones por defecto
    

---

# 11. Evaluación de riesgos

Factores:

- Probabilidad
    
- Impacto
    
- Exposición
    
- Importancia del activo
    

Técnicas:

- CVSS para vulnerabilidades
    
- Scanners (Nessus, OpenVAS)
    

---

# 12. Detención del ataque mediante correlación

Ejemplo real:

1. DNS TXT largo
    
2. Conexión HTTPS con certificado raro
    
3. Proceso Powershell lanzado desde Word
    
4. Transferencia alta de SMB
    
5. RDP lateral
    
6. Exfiltración HTTP
    

Correlación → ransomware o C2.

---

# 13. MITRE ATT&CK relacionado

- **T1020 – Exfiltration**
    
- **T1566 – Phishing**
    
- **T1059 – Execution**
    
- **T1071 – Application Protocol C2**
    
- **T1021 – Remote Services**
    
- **T1003 – Credential Dumping**
    
- **T1135 – Network Share Discovery**
    
- **T1547 – Persistence**
    
- **T1562 – Evasion**
    

---

# 14. ¿Qué debe saber un analista al terminar este módulo?

- Entender cómo se defiende una organización completa
    
- Conectar NIST CSF, NIST 800-61 y Zero Trust
    
- Interpretar controles de seguridad
    
- Leer telemetría y relacionarla
    
- Distinguir entre preventivo, detectivo y correctivo
    
- Comprender cómo funciona un SOC
    
- Saber cómo se ejecuta una respuesta a incidentes
    
- Integrar TI, arquitectura y operaciones
    
- Ver cómo se detiene la cadena de ataque