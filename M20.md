# Módulo 20. Inteligencia de Amenazas (visión SOC)

Este módulo enseña:

1. Qué es inteligencia de amenazas
    
2. Tipos (estratégica, operativa, táctica, técnica)
    
3. IOCs, IOAs y TTPs
    
4. Fuentes de intel (open-source, comerciales y comunitarias)
    
5. Cómo se integra en un SOC
    
6. Cómo se correlaciona con logs
    
7. Cómo se usa MITRE ATT&CK
    
8. Cómo detectar campañas activas
    

---

# 1. ¿Qué es Threat Intelligence?

Threat Intelligence (TI) es información procesada y contextualizada sobre:

- Atacantes
    
- Infraestructura maliciosa
    
- Malware
    
- Técnicas
    
- Campañas activas
    
- Patrones de ataque
    

Su objetivo: **mejorar la detección, la respuesta y la toma de decisiones en seguridad**.

---

# 2. Tipos de Inteligencia de Amenazas

## 2.1 Estratégica

Pensada para directivos.

- Riesgos globales
    
- Tendencias geopolíticas
    
- Nuevos grupos APT
    
- Impacto en el negocio
    

Ejemplo verificable: Informes anuales de Cisco Talos o Mandiant.

## 2.2 Operativa

Información sobre campañas activas.

- Métodos usados
    
- Infraestructura reciente
    
- Malware en circulación
    

Ejemplo: Alertas de US-CERT sobre ransomware.

## 2.3 Táctica

Información sobre **cómo** atacan.

- Técnicas
    
- Procedimientos
    
- Herramientas
    

Fuente: MITRE ATT&CK.

## 2.4 Técnica

Indicadores concretos:

- HASH
    
- IP
    
- dominio
    
- URL
    
- nombre de archivo
    

Fuente: MISP, VT, OTX.

---

# 3. IOCs, IOAs y TTPs

## 3.1 IOC (Indicator of Compromise)

Un artefacto observable que indica compromiso.

Ejemplos verificables:

- HASH SHA256 de malware
    
- IP maliciosa
    
- Dominio C2
    
- Certificado TLS auto-firmado raro
    
- Archivo “invoice.pdf.exe”
    

## 3.2 IOA (Indicator of Attack)

Habla del **comportamiento**, no del artefacto.

Ejemplo:

- PowerShell codificado en Base64
    
- Beaconing cada 60 segundos
    
- DNS con TXT grandes
    

## 3.3 TTPs (Tactics, Techniques & Procedures)

Son las metodologías del atacante.

Marco referencial: **MITRE ATT&CK**.

---

# 4. Fuentes de Inteligencia de Amenazas

### 4.1 Open-source (gratuitas)

- Cisco Talos
    
- AlienVault OTX
    
- MISP Project
    
- PhishTank
    
- Abuse.ch
    
- Spamhaus
    
- CERT internacionales
    

### 4.2 Comerciales

- CrowdStrike
    
- Recorded Future
    
- FireEye/Mandiant
    
- Palo Alto Unit42
    
- FortiGuard
    

### 4.3 Internas (Threat Intel local)

- Indicadores descubiertos por el SOC
    
- Artefactos de investigaciones previas
    
- Hashes propios
    
- Dominios detectados en campañas antiguas
    

---

# 5. Cómo usa Threat Intel un SOC

Proceso general:

1. **Recolectar** IOCs / TTPs
    
2. **Normalizar** (MISP, STIX/TAXII)
    
3. **Integrar** al SIEM
    
4. **Correlacionar** con logs reales
    
5. **Alertar** si aparece un IOC
    
6. **Responder**
    

Ejemplo real verificable:

1. MISP indica que un dominio es usado por Cobalt Strike
    
2. Proxy reporta conexiones hacia ese dominio
    
3. Zeek detecta beaconing periódico TCP de bajo volumen
    
4. SIEM correlaciona → alerta crítica
    
5. SOC aísla host
    
6. EDR confirma malware
    

---

# 6. Técnicas de enriquecimiento (Enrichment)

Se “enriquece” una alerta con:

- Reputación de IP
    
- Información de dominio (WHOIS, creación)
    
- Hash lookup (VirusTotal)
    
- Categoría URL
    
- GeoIP
    
- Reportes MITRE ATT&CK asociados
    
- Clasificación de campaña
    
- Parent processes (si endpoint)
    

Esto transforma un evento aislado en inteligencia procesable.

---

# 7. Marco MITRE ATT&CK (uso SOC)

MITRE no es solo una lista de técnicas:  
Es un mapa para:

- Entender cómo atacan
    
- Detectar fases del ataque
    
- Crear reglas de detección
    
- Construir playbooks
    
- Identificar lagunas defensivas
    
- Realizar threat hunting
    

Ejemplo:  
T1059 (Execution → Command Shell)  
Se correlaciona con eventos PowerShell 4104.

---

# 8. Threat Hunting con TI

El SOC no espera a recibir alertas: caza proactivamente.

Ejemplos de hunts basados en intel:

- Buscar dominios DGA recientes
    
- Ver hosts que hablan con IPs bajas reputación
    
- Buscar procesos que lancen cmd.exe desde Word
    
- Buscar DNS TXT largos
    

---

# 9. Detección basada en TI

### Detección directa:

SIEM compara logs con listas negras de:

- IP
    
- HASH
    
- dominio
    

### Detección indirecta:

Basada en comportamiento:

- Beaconing
    
- Secuencias de eventos
    
- Uso de herramientas ofensivas
    

---

# 10. MISP: plataforma clave

MISP es el estándar abierto.  
Soporta:

- STIX
    
- TAXII
    
- Compartición entre organizaciones
    

El SOC puede automatizar:

- Importación de IOCs
    
- Exportación
    
- Enriquecimiento
    
- Actualización diaria
    

---

# 11. Señales SOC más comunes basadas en TI

|Tipo|Señal|Interpretación|
|---|---|---|
|IOC|Conexión a IP maliciosa|C2 o escaneo|
|IOC|HASH detectado|malware conocido|
|TTP|Powershell codificado|ejecución maliciosa|
|IOA|Beaconing|C2|
|IOC|Dominio recién creado|campaña activa|
|TTP|SMB lateral|movimiento lateral|
|IOC|Certificado raro|TLS tuneling o malware|

---

# 12. MITRE ATT&CK asociado

El módulo entero se relaciona con:

- **T1589 – Gather Victim Identity**
    
- **T1592 – Gather Infrastructure**
    
- **T1595 – Active Scanning**
    
- **T1190 – Exploit Public-Facing Application**
    
- **T1071 – C2 Channels**
    
- **T1020 – Exfiltration**
    
- **T1003 – Credential Dumping**
    
- **T1041 – Exfiltration Over C2**
    
- **T1568 – Exfiltration Over Web Services**
    

---

# 13. ¿Qué debe dominar un analista al terminar este módulo?

- Identificar diferencias entre IOC, IOA y TTP
    
- Integrar amenazas en el SIEM
    
- Enriquecer eventos con intel
    
- Usar MITRE ATT&CK en detecciones
    
- Interpretar campañas activas
    
- Correlacionar IOCs con tráfico real
    
- Detectar C2 basado en intel
    
- Usar MISP, OTX, Cisco Talos
    
- Comprender cómo TI fortalece la defensa
    
- Hacer threat hunting basado en comportamiento