# Módulo 13. Atacantes y sus herramientas (visión SOC)

Los atacantes no son una categoría homogénea; tienen motivaciones, recursos, capacidades y estilos.  
Aquí hablamos de:

1. Tipos de atacantes
    
2. Motivaciones
    
3. Herramientas ofensivas típicas
    
4. Técnicas comunes
    
5. Señales visibles en un SOC
    
6. MITRE ATT&CK asociado
    

---

# 1. Tipos de atacantes

### 1.1 Cybercriminales

- Motivación económica.
    
- Ransomware, phishing, carding, cryptojacking.
    
- Herramientas: Cobalt Strike, Metasploit, malware empaquetado.
    

### 1.2 Hacktivistas

- Motivación ideológica.
    
- DDoS, defacement, filtración de datos.
    
- Herramientas: LOIC/HOIC, scripts simples.
    

### 1.3 Grupos APT (State-sponsored)

- Alta capacidad, espionaje, sabotaje.
    
- Persistencia larga, técnicas avanzadas.
    
- Herramientas: frameworks propios, spear-phishing sofisticado, zero-days.
    

Ejemplos del mundo real:

- APT28 (Rusia)
    
- APT29 (Rusia)
    
- Lazarus Group (Corea del Norte)
    
- APT1 (China)
    

### 1.4 Insiders

- Empleados descontentos
    
- Robo de información
    
- Acceso privilegiado
    
- Difíciles de detectar
    

### 1.5 Script Kiddies

- Baja capacidad
    
- Herramientas preconstruidas
    
- Mucho ruido
    

---

# 2. Motivaciones del atacante

Verificable según Cisco y MITRE:

- Económica (ransomware, BEC)
    
- Política (espionaje)
    
- Personal (insider threats)
    
- Competitiva (espionaje industrial)
    
- Caos / reputación (hacktivismo)
    

La motivación influye en el tipo de herramientas y en la persistencia.

---

# 3. Herramientas ofensivas típicas

Aquí entramos en lo importante para el SOC: **las herramientas dejan huellas**.

## 3.1 Reconocimiento y escaneo

Herramientas:

- **Nmap**
    
- masscan
    
- hping3
    
- zmap
    
- dnsenum
    
- whatweb
    

Señales SOC:

- SYN scans
    
- FIN/Xmas/null scans
    
- Muchos paquetes ICMP
    
- Consultas DNS masivas
    
- Enumeración HTTP con user-agents sospechosos
    

---

## 3.2 Explotación

Herramientas:

- **Metasploit**
    
- Cobalt Strike Beacon
    
- Sliver
    
- Havoc
    
- Empire
    
- SQLmap
    
- Burp Suite
    

Señales SOC:

- Beaconing regular
    
- User-agents raros
    
- Comunicación a intervalos exactos
    
- Exfiltración por POST
    
- Variación mínima de TTL
    

---

## 3.3 Movimiento lateral

Herramientas:

- PsExec
    
- SMBexec
    
- Impacket (wmiexec, smbexec, secretsdump)
    
- WinRM
    
- RDP
    

Señales:

- Muchas conexiones SMB
    
- 4624 + 4672 en Windows
    
- Tareas programadas inesperadas
    
- Servicio extraño creado (7045)
    
- Conexiones RDP fuera de horario
    

---

## 3.4 Credential Access

Herramientas:

- **Mimikatz**
    
- LaZagne
    
- hashcat
    
- John the Ripper
    
- Kerbrute
    

Señales SOC:

- Acceso a LSASS (Sysmon EventID 10)
    
- Muchas autenticaciones fallidas
    
- Lectura de NTDS.dit
    
- 4625/Fallas Kerberos sucesivas
    
- Bloqueos de cuenta por intentos masivos
    

---

## 3.5 Persistencia

Métodos:

- Claves de registro Run/RunOnce
    
- Tareas programadas
    
- Servicios nuevos (7045)
    
- Backdoors SSH
    
- DLL hijacking
    
- Webshells
    

Señales:

- Cambios en autoruns
    
- Creación de archivos en AppData
    
- Nuevo usuario local
    
- Cambios en sshd_config
    

---

## 3.6 Evasión

Herramientas:

- ofuscadores
    
- packers
    
- crypters
    
- LOLBins (Living-off-the-land binaries):
    
    - powershell.exe
        
    - certutil.exe
        
    - bitsadmin.exe
        
    - mshta.exe
        
    - rundll32.exe
        

Señales:

- Powershell codificado en Base64
    
- Certutil descargando payloads
    
- mshta ejecutando JS remoto
    
- procesos anómalos
    

---

## 3.7 Exfiltración

Métodos:

- DNS tunneling
    
- HTTP POST grande
    
- HTTPS cifrado con certificados propios
    
- FTP/SFTP
    
- reverse shells
    
- cloud storage no autorizado
    

Señales:

- Consultas DNS TXT largas
    
- Sesiones HTTPS sin SNI
    
- Conexiones persistentes de baja frecuencia
    
- Tráfico saliente elevado
    

---

# 4. Cómo detecta todo esto un SOC

El SOC usa:

- SIEM (Elastic, Splunk, QRadar)
    
- Zeek (conn.log, dns.log, http.log, ssl.log)
    
- Suricata (EVE alerts)
    
- Wazuh / Sysmon
    
- Threat Intelligence (MISP, Talos, VirusTotal)
    

### Indicadores típicos:

- Beaconing cada X segundos
    
- Cambios de ARP
    
- Procesos sospechosos en Windows/Linux
    
- Nuevos servicios
    
- Conexiones SMB laterales
    
- RDP externo
    
- Certificados TLS auto-generados
    
- User-agents ofensivos
    
- Payloads anómalos
    

---

# 5. MITRE ATT&CK: técnicas asociadas

Técnicas más directamente relacionadas con este módulo:

- **T1595 – Active Scanning**
    
- **T1059 – Execution**
    
- **T1203 – Exploitation for Client Execution**
    
- **T1135 – Network Shares Discovery**
    
- **T1047 – WMI Execution**
    
- **T1053 – Scheduled Task**
    
- **T1036 – Masquerading**
    
- **T1040 – Network Sniffing**
    
- **T1555 / T1558 – Credential Access**
    
- **T1021 – Remote Services**
    
- **T1071 – C2 over HTTP/HTTPS**
    
- **T1041 – Exfiltration**
    

---

# 6. ¿Qué debe saber un analista al terminar este módulo?

Debes ser capaz de:

- Identificar tipos de atacante
    
- Entender motivaciones
    
- Reconocer herramientas ofensivas por patrones
    
- Detectar escaneo, explotación, lateral movement
    
- Interpretar señales en logs
    
- Asociar técnicas a MITRE ATT&CK
    
- Diferenciar ruido de actividad maliciosa
    
- Reconocer C2 por beaconing
    
- Detectar exfiltración encubierta
    
- Relacionar comportamiento con herramientas típicas