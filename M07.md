# Módulo 7. Principios de Seguridad en Red (visión SOC)

El módulo gira alrededor de tres preguntas clave:

1. ¿Cómo se protege una red?
    
2. ¿Qué controles existen?
    
3. ¿Qué señales observables indican que un control ha fallado o está siendo evadido?
    

---

# 1. Principio fundamental: **Defensa en profundidad**

Cisco y NIST coinciden en el modelo de capas superpuestas:

- Capa física
    
- Capa de red
    
- Capa de transporte
    
- Capa de aplicación
    
- Capa de usuario
    
- Capa de monitoreo
    

Si un atacante rompe una capa, todavía encuentra otras barreras.

Ejemplo real verificable:  
Un atacante puede evadir un firewall L3, pero no logra pasar un WAF o un IDS bien configurado.

---

# 2. Segmentación de red

La segmentación divide la red en dominios más pequeños y controlables.

Tipos:

- **VLANs (802.1Q)**
    
- **Subredes**
    
- **Zonas de seguridad** (DMZ, LAN, Servers, OT)
    
- **Microsegmentación** (Zero Trust)
    

Beneficios:

- Limita movimiento lateral
    
- Reduce superficie de ataque
    
- Mantiene visibilidad en SOC
    

En un SOC, la segmentación se refleja en logs:

- Tráfico SMB solo en VLAN de servidores
    
- RDP solo desde jump hosts
    
- SSH solo desde redes administrativas
    

Si aparece tráfico cruzado fuera de su zona, es señal de intrusión.

---

# 3. Firewalls

El firewall es la primera muralla lógica.

Tipos:

### 3.1 Firewall de filtrado clásico (ACL)

Filtra IP/puerto/protocolo.

Ejemplo Cisco IOS ACL:

`access-list 100 permit tcp 192.168.10.0 0.0.0.255 host 10.1.0.5 eq 22`

Señales SOC:

- Trafico bloqueado repetidamente desde la misma IP
    
- Flujo de intentos a puertos no autorizados
    
- Cambios abruptos en reglas
    

### 3.2 Stateful Firewall

Mantiene la tabla de conexiones.  
Cisco ASA/FTD, Palo Alto, etc.

Beneficios:

- Detecta conexiones ilegítimas
    
- Rechaza paquetes fuera de estado
    

### 3.3 Next-Generation Firewall (NGFW)

Incluye:

- Inspección profunda (DPI)
    
- IDS/IPS integrado
    
- Control de aplicaciones
    
- TLS Decryption
    

Estos dispositivos generan logs muy útiles para SOC:

- Malware blocked
    
- High-risk application
    
- C2 communication detected
    

---

# 4. IDS/IPS

Los **IDS/IPS** detectan y bloquean patrones maliciosos.

Ejemplos:

- **Snort**
    
- **Suricata**
    
- **Zeek**
    
- **Cisco Firepower**
    

Los IDS detectan:

- Escaneo
    
- Anomalías
    
- Firmas conocidas
    
- Ataques a nivel protocolo
    
- Evasión y fragmentación
    

Ejemplo verificable:  
Suricata detecta un “ET SCAN Nmap Scripting Engine User Agent” cuando se usa `nmap -sV`.

---

# 5. Políticas de red y control de acceso

El control de acceso asegura que solo usuarios autorizados acceden a recursos específicos.

### 5.1 AAA (Authentication, Authorization, Accounting)

Cisco ISE, FreeRADIUS, Active Directory.

- Authentication: “¿Quién eres?”
    
- Authorization: “¿Qué puedes hacer?”
    
- Accounting: “¿Qué hiciste?”
    

### 5.2 NAC (Network Access Control)

Permite aplicar políticas al conectar un dispositivo a la red.

Verificable:  
Cisco ISE (802.1X), Aruba ClearPass.

Señales SOC:

- MAC spoofing
    
- Saltarse 802.1X
    
- Dispositivos rogue conectados inesperadamente
    

---

# 6. DMZ (Zona desmilitarizada)

Una DMZ separa servicios expuestos al público del resto de la red interna.

Ejemplos típicos:

- Servidores web
    
- DNS públicos
    
- Bastion hosts
    

Un SOC revisa:

- ¿Este servidor DMZ está hablando con la LAN interna?
    
- ¿Está enviando tráfico a IPs extrañas?
    
- ¿Se está moviendo lateralmente hacia servidores internos?
    

Si sí, hay potencial compromiso.

---

# 7. VPNs (Virtual Private Networks)

Los túneles cifrados permiten acceso remoto seguro.

Tipos:

- IPsec
    
- SSL VPN
    
- AnyConnect (Cisco)
    

Logs verificables en un SOC:

- Conexiones desde países inesperados
    
- Conexiones simultáneas
    
- Cambios bruscos de IP pública
    
- Intentos fallidos de autenticación (AAA)
    

---

# 8. Modelo Zero Trust (NIST 800-207)

El pilar moderno de seguridad:

- Nunca confíes.
    
- Verifica siempre.
    
- Aplica el mínimo privilegio.
    
- Segmenta cada recurso.
    
- Analiza continuamente comportamiento.
    

Ejemplos:

- Acceso basado en identidad
    
- Microsegmentación
    
- Políticas dinámicas
    
- Evaluación continua del contexto
    

En un SOC, Zero Trust significa:

- Telemetría constante
    
- Visibilidad completa
    
- Alertas basadas en comportamiento
    

---

# 9. Seguridad de DNS

DNS es objetivo frecuente de ataques:

- DNS tunneling
    
- Domain generation algorithms (DGA)
    
- Cache poisoning
    
- Query flood
    

Un SOC utiliza:

- Zeek dns.log
    
- Suricata dns events
    
- Threat intelligence para dominios maliciosos
    

Señales:

- Consultas TXT con payload grande
    
- Dominios recién creados (NOD)
    
- Alta frecuencia hacia un dominio único
    

---

# 10. Email Security (fundamental en Cisco)

El email es vector principal de ataque:

- Phishing
    
- Malware adjunto
    
- BEC (Business Email Compromise)
    

Controles:

- SPF, DKIM, DMARC
    
- Sandboxing
    
- Anti-phishing gateways
    
- Reglas DLP
    

Cisco usa **Cisco Email Security Appliance** (ESA).

---

# 11. Seguridad en aplicaciones web (WAF)

Un WAF protege contra:

- SQL Injection
    
- XSS
    
- CSRF
    
- File Inclusion
    
- Directory Traversal
    

Ejemplos:

- ModSecurity
    
- F5 ASM
    
- Cloudflare WAF
    

Un SOC revisa:

- Reglas que disparan ataques
    
- Patrones en URLs
    
- User-agents sospechosos
    

---

# 12. Señales SOC que indican fallo de seguridad en red

- Aumentos de tráfico inusual
    
- Conexiones a puertos no usados
    
- Paquetes fuera de estado
    
- Consultas DNS repetidas
    
- Tráfico SMB entre redes que no deben comunicarse
    
- Autenticaciones fallidas masivas
    
- RDP desde IPs externas
    
- ARP inconsistente
    
- Flujos largos (beaconing C2)