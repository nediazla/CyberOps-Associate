# Módulo 16. Ataques a los Fundamentos (visión SOC)

Estos ataques operan en las capas más bajas:

- Capa de Enlace (Ethernet, ARP)
    
- Capa de Internet (IP, ICMP)
    
- Capa de Transporte (TCP/UDP)
    

Son ataques que buscan:

- Reconocimiento
    
- Evasión de IDS/Firewall
    
- Interrupción del servicio
    
- Manipulación de tráfico
    
- Preparar fases posteriores (explotación, lateral movement, etc.)
    

---

# 1. Ataques de escaneo (Scanning)

Los atacantes mapearán siempre la red antes de atacar.

## 1.1 Escaneo TCP

Herramientas: **Nmap, Masscan, HPing3**

Tipos:

- SYN scan (half-open)
    
- Connect scan
    
- FIN scan
    
- Xmas scan
    
- Null scan
    
- ACK scan (firewall rule mapping)
    

### Señales SOC:

- Muchos SYN a puertos distintos
    
- Handshakes incompletos
    
- Flags TCP anormales
    
- RST masivos
    
- IPs probando todos los puertos de un host
    

Suricata:  
“ET SCAN Nmap OS Discovery”  
“ET SCAN Nmap SYN Scan”

Zeek:  
conn.log con _conn_state=S0, S1, S2 repetidos_.

---

# 2. Ataques ICMP

ICMP es un protocolo de diagnóstico pero se abusa en:

## 2.1 Ping Sweep

Enumeración de hosts activos.

Señales:

- ICMP Echo Requests consecutivos
    
- Distintos destinos en corto tiempo
    

## 2.2 ICMP Flood (DoS)

Envío masivo de ICMP para saturar la red.

## 2.3 ICMP Tunneling

Usado para exfiltrar datos.

Indicios:

- ICMP con payload grande
    
- ALTAS tasas de reply
    
- Frecuencia constante (C2)
    

Zeek: icmp.log  
Suricata: “icmp excessive echo”

---

# 3. Spoofing (suplantación)

## 3.1 IP Spoofing

Modificación de IP origen para ocultar al atacante.

Señales:

- TTL inconsistente
    
- Rutas imposibles
    
- Paquetes sin retorno posible
    

## 3.2 ARP Spoofing

Ya visto en módulo 8.

Señales:

- Cambios de MAC en gateway
    
- ARP replies no solicitados
    

## 3.3 DNS Spoofing

Manipulación de respuestas DNS.

Señales:

- DNS answers inesperados
    
- TTL extremadamente bajo
    
- Respuestas desde servidores no autorizados
    

---

# 4. Floods (DoS)

## 4.1 SYN Flood

Inundación de SYN sin terminar handshake.

Señales SOC:

- Miles de S0 en conn.log
    
- Server half-open queue saturada
    
- CPU del firewall aumentando
    

## 4.2 UDP Flood

Trafico excesivo a puertos UDP.

## 4.3 ACK Flood

Flood para forzar al firewall a verificar estado.

## 4.4 ICMP Flood

Clásico ping flood.

## 4.5 Amplificación

- DNS amplification
    
- NTP amplification
    
- SSDP amplification
    
- Memcached amplification
    

Señales:

- PPS (packets per second) extremadamente alto
    
- Paquetes mucho más grandes que los enviados por víctima
    

---

# 5. Ataques de fragmentación

## 5.1 Tiny Fragment Attack

Divide cabecera en trozos para evadir firewall tradicional.

## 5.2 Overlapping Fragments (Fragment Smashing)

Intenta confundir reensamblado del IDS.

Zeek produce weird log entries como:

- “fragment_inconsistency”
    
- “truncated_header”
    

## 5.3 Teardrop

Histórico.  
Envío de fragmentos solapados que causaban fallo de OS antiguas.

---

# 6. Manipulación de TCP

## 6.1 Session hijacking

Secuestro de sesión alterando números de secuencia.

Indicadores:

- Sequence numbers extraños
    
- RST inesperados
    

## 6.2 TCP Reset Attack

Enviar RST falsos.

## 6.3 ACK Storm

Dos hosts enviando ACK infinitos (loop).

---

# 7. Evasión de IDS/Firewalls

Técnicas usadas por atacantes avanzados:

- Fragmentación artificial
    
- Alteración del orden de paquetes
    
- Payloads codificados
    
- Uso de puertos no estándar
    
- Paquetes no RFC-compliant
    
- Cambios en TTL para confundir normalizadores
    

Suricata genera alertas tipo:

- “Invalid TCP options”
    
- “Malformed packet”
    
- “Evasive traffic detected”
    

---

# 8. Ataques a protocolos básicos

## 8.1 DHCP Starvation

Agota el pool de direcciones.

## 8.2 Rogue DHCP

Servidor falso.

## 8.3 NDP Spoofing (IPv6)

Similar a ARP spoofing.

---

# 9. Detectar estos ataques en un SOC

### Zeek:

- conn.log
    
- weird.log
    
- notice.log
    
- dns.log
    
- icmp.log
    
- netflows
    

### Suricata:

- ET SCAN
    
- ET DOS
    
- ET INFO
    
- ET POLICY
    
- decoder events
    

### Firewall:

- SYN flood detection
    
- Anomalías L4
    
- Paquetes fuera de estado
    

### SIEM:

- Análisis de frecuencia
    
- Correlación de flags
    
- Detección de patrones repetitivos
    
- Detección de N eventos en X tiempo
    

---

# 10. MITRE ATT&CK asociado

- **T1046 – Network Scanning**
    
- **T1498 – Network DoS**
    
- **T1090 – Proxying / obfuscation**
    
- **T1040 – Network Sniffing**
    
- **T1583 – Acquire Infrastructure**
    
- **T1562 – Defense Evasion**
    
- **T1557 – MITM**
    
- **T1021 – Remote Services**
    
- **T1041 – Exfiltration**
    

---

# 11. ¿Qué debe dominar el analista?

Al finalizar este módulo un analista debe:

- Reconocer escaneos por flags TCP
    
- Detectar spoofing
    
- Identificar floods
    
- Interpretar fragmentación anómala
    
- Ver tráfico evasivo
    
- Separar ruido de escaneo legítimo (Zabbix, monitoreo)
    
- Reconocer patrones de DoS y DDoS
    
- Detectar preparación de intrusión