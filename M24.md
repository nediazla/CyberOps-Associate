# Módulo 24. Tecnologías de Seguridad y Protocolos (visión SOC)

Este módulo cubre:

1. VPNs (IPsec, SSL VPN)
    
2. Firewalls (clásicos y NGFW)
    
3. IDS/IPS
    
4. NAC (802.1X, EAP)
    
5. Protocolos de autenticación
    
6. Kerberos
    
7. SAML / OAuth / OpenID Connect
    
8. Cifrado y TLS
    
9. Protocolos de logging (Syslog, NetFlow/IPFIX)
    
10. Túneles y encapsulación
    
11. Señales SOC
    
12. MITRE
    

Vamos uno por uno.

---

# 1. VPNs (Virtual Private Networks)

Las VPN permiten crear comunicaciones seguras entre redes o endpoints.

## 1.1 IPsec VPN (Site-to-Site)

Protocolo estandarizado en RFC 4301.

Usa:

- IKE (Internet Key Exchange)
    
- ESP (Encapsulating Security Payload)
    
- AH (Authentication Header)
    
- Cifrado: AES, 3DES
    
- Integridad: SHA-256/384
    

Fases:

1. IKE Phase 1 → túnel seguro
    
2. IKE Phase 2 → intercambio de claves / seguridad de datos
    

SOC señales:

- fallos de IKE
    
- reintentos de túnel
    
- tráfico encapsulado ESP anómalo
    
- cambios en peer-ID
    

## 1.2 SSL/TLS VPN (Remote Access)

Usa TLS para autenticar al usuario y cifrar tráfico.

Señales SOC:

- conexiones desde IP inusual
    
- fallos de autenticación
    
- tráfico excesivo de un usuario
    
- túneles activos fuera de horario
    

---

# 2. Firewalls

## 2.1 Firewall tradicional L3/L4

Filtra por:

- IP origen/destino
    
- puertos
    
- flags TCP
    

## 2.2 NGFW (Next-Gen Firewall)

Agrega:

- inspección profunda (DPI)
    
- IPS integrado
    
- control de aplicaciones
    
- seguridad web
    
- descifrado TLS
    

SOC señales:

- bloqueos repetidos
    
- flujos fuera de política
    
- alertas IPS
    
- conexiones TLS anómalas
    

---

# 3. IDS/IPS

IDS = detección  
IPS = detección + bloqueo

Ejemplos:

- Snort
    
- Suricata
    
- Cisco Firepower
    

SOC señales:

- firmas de ataque
    
- anomalías
    
- evasiones
    
- patrones malformados
    
- explotación CVE
    

---

# 4. NAC (Network Access Control)

Basado en:

- **802.1X** (control por puerto)
    
- **EAP** (método de autenticación)
    
- Certificados (EAP-TLS)
    
- Posture (estado del dispositivo)
    

## 4.1 802.1X

Autenticación a nivel de switch o AP.

## 4.2 EAP (Extensible Authentication Protocol)

Tipos:

- EAP-TLS (certificados – más seguro)
    
- PEAP
    
- EAP-TTLS
    

Señales SOC:

- fallos repetidos
    
- dispositivos desconocidos
    
- MAC spoofing
    
- bypass MAB
    

---

# 5. Protocolos de Autenticación

### 5.1 PAP (Password Authentication Protocol)

- No cifrado
    
- Obsoleto
    

### 5.2 CHAP (Challenge Handshake Authentication Protocol)

- Usa desafío y respuesta
    
- Más seguro que PAP
    

### 5.3 MS-CHAPv2

Extensión de Microsoft.  
Todavía usado, pero con debilidades.

Señales SOC:

- degradación de método (downgrade)
    
- ataques de diccionario
    
- negociación inconsistente
    

---

# 6. Kerberos

El sistema de autenticación moderno de Active Directory.

Componentes:

- KDC (Key Distribution Center)
    
- AS (Authentication Service)
    
- TGS (Ticket Granting Service)
    
- TGT (Ticket Granting Ticket)
    

Proceso:

1. Usuario pide TGT
    
2. Recibe ticket
    
3. Usa ticket para acceder a servicios
    

Ataques:

- Pass-the-Ticket
    
- Overpass-the-Hash
    
- Kerberoasting
    
- AS-REP Roasting
    

SOC señales:

- Tickets anómalos
    
- Solicitudes TGS inusuales
    
- Digests débiles (RC4)
    
- Uso de cuentas de servicio no esperadas
    

MITRE: **T1558**

---

# 7. SAML, OAuth y OpenID Connect

Estos protocolos permiten autenticación federada y Single Sign-On.

## 7.1 SAML

Usado en empresas.  
XML firmado.

## 7.2 OAuth 2.0

Control de acceso delegados para APIs.

## 7.3 OpenID Connect

Capa de identidad sobre OAuth.

Problemas típicos:

- tokens robados
    
- scopes excesivos
    
- expiración larga
    
- replay attacks
    

SOC señales:

- tokens desde IP desconocida
    
- accesos externos sin MFA
    
- tokens usados en varios países en poco tiempo
    

---

# 8. TLS

Revisado en el módulo 21, pero aquí se usa desde perspectiva de red.

Aspectos clave:

- versiones soportadas
    
- cipher suites
    
- renegociación
    
- SNI
    

SOC señales:

- certificados auto-firmados
    
- TLS 1.0
    
- ALPN no estándar
    
- túneles ocultos
    

---

# 9. Syslog

Protocolo para enviar logs a un servidor central.

Formato:

- Facility
    
- Severity
    
- Mensaje
    

SOC uso:

- correlación
    
- retención
    
- normalización
    

---

# 10. NetFlow / IPFIX

Telemetría que resume flujos de red.

Campos típicos:

- src/dst IP
    
- src/dst port
    
- protocolo
    
- bytes
    
- packets
    

SOC uso:

- detectar beaconing
    
- ver escaneos
    
- analizar exfiltración
    
- evaluar DoS
    

---

# 11. Túneles y Encapsulación

Usos legítimos y maliciosos.

Ejemplos:

- GRE
    
- VPN IPsec
    
- SSL
    
- SSH tunnels
    
- ICMP tunnels
    

Señales SOC:

- tráfico encapsulado sin razón
    
- conexiones con payloads anómalos
    
- patrones de beaconing
    

---

# 12. Señales SOC sobre tecnologías de seguridad

|Tecnología|Señal|Interpretación|
|---|---|---|
|VPN|intentos fallidos|brute force|
|Kerberos|TGS mass requests|kerberoasting|
|OAuth|token reuse|robo de token|
|TLS|certificado raro|C2 HTTPS|
|802.1X|fallo MAB|identidad falsa|
|IPS|firmas críticas|exploit activo|
|NetFlow|low-byte beaconing|C2 oculto|
|Syslog|bursts de errores|ataque o fallo de servicio|

---

# 13. MITRE ATT&CK relacionado

- **T1071 – Protocolos C2**
    
- **T1095 – Non-Application Layer Protocol**
    
- **T1134 – Token Manipulation**
    
- **T1550 – Use of Stolen Credentials**
    
- **T1040 – Sniffing**
    
- **T1556 – Modify Authentication**
    
- **T1588 – Obtain Capabilities**
    
- **T1090 – Proxying**
    
- **T1572 – Protocol Tunneling**
    
- **T1609 – Container Escaping**
    

---

# 14. ¿Qué debe dominar un analista al terminar este módulo?

- Cómo funcionan VPNs reales (IPsec/SSL)
    
- Cómo interpretar logs de firewall/IPS
    
- Cómo detectar abuso de Kerberos
    
- Cómo correlacionar tokens OAuth/SAML
    
- Cómo identificar túneles maliciosos
    
- Entender NetFlow/IPFIX para detección
    
- Interpretar syslog y telemetría
    
- Identificar fallos de autenticación (PAP/CHAP/MS-CHAPv2)
    
- Detectar actividad sospechosa en TLS
    
- Conectar controles de seguridad con señales del SOC